webpackJsonp([52],{"310t":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("aA9S"),n=i.n(s),a=i("4YfN"),l=i.n(a),o=i("9rMa"),r=(i("EuEE"),i("r2UX")),_=i("6nXL"),c=i("P9l9"),p=i("a2vD"),d=i("N6PA"),u={data:function(){return{emptyType:1,agentId:p.a.getAgentid(),isEdit:!1,posiData:[],row:{},role_name:null,role_name_err:!1,pl_po_id:null,pl_po_id_err:!1,editDialog:!1,pl_role_id:null,list:[],IsEdit:_.v,total:10,listQuery:{page:1,limit:10}}},created:function(){this.getList(),this.getPositionList()},components:{EmptyTable:r.a},computed:l()({role_title:function(){return this.isEdit?"编辑角色":"新增角色"}},Object(o.d)({ACS:function(t){return t.perimission.sysPermis},PL_K:function(t){return t.perimission.PL_K}})),methods:{getList:function(){var t=this;if(this.ACS[this.PL_K.ROLE_LIST_SEE]){var e={get_pl_role_list:1,page_size:this.listQuery.limit,page_no:this.listQuery.page};Object(c.X)(e).then(function(e){0===e.ret?(t.list=e.data.list,t.listQuery.page>1&&0===t.list.length&&(t.listQuery.page--,t.getList()),t.total=e.data.total):t.$slnotify({message:_.X.toString(e.ret)})})}},getPositionList:function(){var t=this;Object(c.V)({get_pl_position_list:1,page_size:1e5,page_no:1}).then(function(e){0===e.ret?t.posiData=e.data.position_list||[]:t.$slnotify({message:_.X.toString(e.ret)})})},select_posi:function(t){this.pl_po_id_err=!1,this.pl_po_id=t.pl_position_id},handleSave:function(){var t=this;if(this.checkrole_name()&&this.checkpl_id()){var e={save_pl_role:1,role_name:this.role_name,pl_position_id:this.pl_po_id};this.row.pl_role_id&&(e.pl_role_id=this.row.pl_role_id),console.log("保存=>",e),Object(c.Y)(e).then(function(e){0==e.ret?(t.$slnotify({message:"保存成功",duration:1500}),t.getList(),t.clearClose()):t.$slnotify({message:_.X.toString(e.ret),duration:1500})})}},clearTip:function(){this.role_name_err=!1,this.pl_po_id_err=!1},addRole:function(){this.ACS[this.PL_K.ADD_ROLE]?(this.row={},this.role_name="",this.pl_po_id=null,this.editDialog=!0,this.isEdit=!1):this.$slnotify({message:"操作权限不足"})},edit:function(t){if(this.ACS[this.PL_K.EDIT_ROLE]){this.isEdit=!0;var e=n()({},t);this.row=e,this.role_name=this.row.role_name,this.pl_po_id=this.row.pl_position_id,this.editDialog=!0}else this.$slnotify({message:"操作权限不足"})},handleDelete:function(t){var e=this;if(this.ACS[this.PL_K.DEL_ROLE]){n()({},t);this.row=t;var i={delete_pl_role:1,pl_role_id:this.row.pl_role_id};Object(c.Y)(i).then(function(t){0==t.ret?(e.$slnotify({message:"删除成功",duration:1500}),e.getList()):-30039===t.ret?e.$slnotify({message:"该角色已经被员工使用，不可删除"}):e.$slnotify({message:_.X.toString(t.ret),duration:1500})})}else this.$slnotify({message:"操作权限不足"})},clearClose:function(){this.editDialog=!1,this.row={},this.role_name="",this.pl_po_id=null,this.pl_role_id=null},checkrole_name:function(){var t=this.role_name,e=!d.a.isEmpty(t);return(!e||t.trim().indexOf(" ")>=0)&&(this.role_name_err=!0,e=!1),e},checkpl_id:function(){var t=this.pl_po_id,e=!d.a.isEmpty(t);return(!e||t.trim().indexOf(" ")>=0)&&(this.pl_po_id_err=!0,e=!1),e},handleSizeChange:function(t){this.listQuery.limit=t,this.listQuery.page=1,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()}},mounted:function(){this.$refs.manageGoodsListTableAdjust.$refs.bodyWrapper.style.minHeight="437px"}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"change-default rankTableOfficial role-box"},[i("div",{staticClass:"change-titlerr rank-title rank-title-official"},[i("span",[t._v("角色列表")]),t._v(" "),i("span",{staticClass:"fr add-btn",on:{click:t.addRole}},[i("span",{staticClass:"add-btn-blue"}),t._v("\n      新增角色\n    ")])]),t._v(" "),i("div",{staticClass:"table-official"},[i("el-table",{ref:"manageGoodsListTableAdjust",attrs:{data:t.list,border:"",stripe:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{label:"角色","min-width":"50%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.role_name)+"\n          ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"20%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"text-blue btn-oprate-blue",attrs:{type:"text"},on:{click:function(i){t.edit(e.row)}}},[t._v("编辑\n          ")]),t._v(" "),e.row.entry_type!==t.IsEdit.YES?i("span",{staticClass:"text-red btn-oprate-red table-btn",attrs:{type:"text"},on:{click:function(i){t.handleDelete(e.row)}}},[t._v("删除\n          ")]):t._e()]}}])})],1),t._v(" "),t.list&&0!==t.list.length?t._e():i("empty-table",{attrs:{type:t.emptyType}})],1),t._v(" "),i("div",{staticClass:"pagination-content change-pagination-default",attrs:{slot:"pagination"},slot:"pagination"},[i("el-pagination",{staticClass:"sl-pagination page-el",attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,40],"page-size":t.listQuery.limit,layout:"sizes, jumper, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1),t._v(" "),i("el-dialog",{attrs:{visible:t.editDialog,"close-on-click-modal":!1,top:"22vh",width:"540px"},on:{"update:visible":function(e){t.editDialog=e},close:t.clearClose}},[i("div",[i("div",{staticClass:"head-nav"},[i("span",[t._v(t._s(t.role_title))])]),t._v(" "),i("div",{staticClass:"form-item"},[i("div",{staticClass:"form-label"},[i("span",{staticClass:"sl-must"}),t._v(" 角色名称\n        ")]),t._v(" "),i("div",{staticClass:"form-input"},[i("el-input",{class:{"border-redtip":t.role_name_err},attrs:{placeholder:"请输入"},on:{blur:t.checkrole_name},nativeOn:{input:function(e){return t.clearTip(e)}},model:{value:t.role_name,callback:function(e){t.role_name=e},expression:"role_name"}}),t._v(" "),t.role_name_err?i("div",{staticClass:"errtip"},[i("span",[t._v("请输入角色名称")])]):t._e()],1)]),t._v(" "),i("div",{staticClass:"form-item"},[i("div",{staticClass:"form-label"},[i("span",{staticClass:"sl-must"}),t._v(" 职级分配\n        ")]),t._v(" "),i("div",{staticClass:"form-input cleafix"},[t._l(t.posiData,function(e){return i("span",{key:e.pl_position_id,staticClass:"select-po fl",class:{active:t.pl_po_id===e.pl_position_id},on:{click:function(i){t.select_posi(e)}}},[t._v("\n            "+t._s(e.pl_position_name)+"\n          ")])}),t._v(" "),t.pl_po_id_err?i("div",{staticClass:"errtip"},[i("span",[t._v("请选择关联职位")])]):t._e()],2)]),t._v(" "),i("div",{staticClass:"foot-btn-box"},[i("div",{staticClass:"btn of-btn-bd-m-blue",on:{click:t.clearClose}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"btn save-s-gradient",on:{click:t.handleSave}},[t._v("保存")])])])])],1)},staticRenderFns:[]};var f=i("C7Lr")(u,h,!1,function(t){i("RCRZ"),i("oDvb"),i("91lQ")},"data-v-0338844f",null);e.default=f.exports},"91lQ":function(t,e){},RCRZ:function(t,e){},oDvb:function(t,e){}});