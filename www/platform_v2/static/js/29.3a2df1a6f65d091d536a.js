webpackJsonp([29],{"0Rht":function(t,e){},"5aCZ":function(t,e,i){"use strict";var n=i("rVsN"),s=i.n(n),a=i("ZLEe"),l=i.n(a),c=i("a2vD"),o={name:"editorSlideUpload",props:{color:{type:String,default:"#20a0ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],url:"./php/img_save.php",uploadData:{upload:1,userid:c.a.getUserid()},base_url:"./php"}},methods:{checkAllSuccess:function(){var t=this;return l()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=l()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var i=e.uid,n=l()(this.listObj),s=0,a=n.length;s<a;s++)if(this.listObj[n[s]].uid===i)return this.listObj[n[s]].url=t.files.file,void(this.listObj[n[s]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=l()(this.listObj),n=0,s=i.length;n<s;n++)if(this.listObj[i[n]].uid===e)return void delete this.listObj[i[n]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,n=t.uid;return this.listObj[n]={},new s.a(function(s,a){var l=new Image;l.src=i.createObjectURL(t),l.onload=function(){e.listObj[n]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},s(!0)})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{attrs:{icon:"upload",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("\n    上传图片\n  ")]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{action:t.url,data:t.uploadData,multiple:!0,name:"imgfile","file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var d={name:"tinymce",components:{editorImage:i("C7Lr")(o,r,!1,function(t){i("Qhv/")},"data-v-fad10c60",null).exports,SlUpload:i("GAg9").a},props:{id:{type:String},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return["styleselect removeformat undo redo |  bullist numlist | forecolor | bold italic blockquote | fullscreen code ","alignleft aligncenter alignright | link | fontsizeselect"]}},menubar:{default:""},height:{type:Number,required:!1,default:360},noImgupload:{type:Boolean,default:!1}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id||"vue-tinymce-"+ +new Date}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t)})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;console.log(window.tinymce),window.tinymce.init({selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body",object_resizing:!1,language:"zh_CN",toolbar:this.toolbar,menubar:this.menubar,plugins:"advlist,autolink,code,paste,textcolor, colorpicker,fullscreen,link,lists,media,wordcount, imagetools,image",end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["wpimg.wallstcn.com","wallstreetcn.com"],imagetools_toolbar:"watermark",default_link_target:"_blank",link_title:!1,formats:{},init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp",function(){t.hasChange=!0,t.$emit("input",i.getContent({format:"raw"}))})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},getImage:function(t){window.tinymce.get(this.tinymceId).insertContent('<img class="wscnph" src="http://platform'+window.full_url+"/php/img_get.php?img=1&imgname="+t+'" >')}},destroyed:function(){this.destroyTinymce()}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),e("div",{staticClass:"editor-custom-btn-container"},[this.noImgupload?this._e():e("sl-upload",{staticClass:"editor-upload-btn",attrs:{FreedomCrop:!0},on:{"send-image":this.getImage}})],1)])},staticRenderFns:[]};var h=i("C7Lr")(d,u,!1,function(t){i("Rx1W")},"data-v-4b3ba006",null);e.a=h.exports},KJ0n:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("6ROu"),s=i.n(n),a=i("5aCZ"),l=i("6nXL"),c=i("a2vD"),o=i("P9l9"),r={components:{Tinymce:a.a},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},articleTypeOption:[{label:l.g.toString(l.g.COMPANY),value:l.g.COMPANY}],articleType:"",articleTitle:"",articleContent:"",msgSengTime:"",sengTimeDialog:!1,articleid:""}},computed:{isShowBtn:function(){return!!(this.articleType&&this.articleTitle&&this.articleContent&&'<p><br data-mce-bogus="1"></p>'!==this.articleContent&&0!==this.articleTitle.replace(/(^\s*)|(\s*$)/,"").length)}},created:function(){this.articleid=this.$route.query.articleid||"",this.articleid&&this.getarticle()},methods:{getarticle:function(){var t=this,e={get_article_info:1,article_id:this.articleid};Object(o.p)(e).then(function(e){if(0===e.ret){var i=e.data.info;t.articleType=i.article_type,t.articleTitle=i.title,t.articleContent=i.content}else t.$slnotify({message:l.N.toString(e.ret),duration:1e3})})},cantSendTip:function(){this.$slnotify({message:"请填写完整信息",duration:1e3})},openSengTimeDialog:function(){this.sengTimeDialog=!0},hideSengTimeDialog:function(){this.sengTimeDialog=!1},closeHandler:function(){this.msgSengTime=""},send:function(t){var e=this;if(console.log("11111111111"),!t||this.msgSengTime){var i={article_save:1,article_type:this.articleType,title:this.articleTitle.trim(),content:this.articleContent};i.platformer_id=c.a.getPlatformerid(),this.articleid&&(i.article_id=this.articleid),this.checkData()||(this.msgSengTime&&(i.send_time=parseInt(s()(this.msgSengTime).format("X"))),Object(o.q)(i).then(function(t){0===t.ret?(e.$slnotify({message:"发布成功",duration:1500}),setTimeout(function(){e.$router.push("/official/website/news")},1500)):e.$slnotify({message:l.N.toString(t.ret),duration:1e3})}))}else this.$slnotify({message:"请选择发送时间！"})},cancel:function(){this.$router.push("/official/website/news")},checkData:function(){var t=!1;this.msgSengTime&&(parseInt(s()(this.msgSengTime).format("x"))<Date.now()&&(t=!0,this.$slnotify({message:"设定的时间已经过期",duration:1500})));return t}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"editore-article"}},[i("div",{staticClass:"nav-own-bar"},[i("span",{staticClass:"cant-click-nav"},[t._v("官网管理")]),t._v("\n    >\n    "),i("span",{staticClass:"can-click-nav",on:{click:t.cancel}},[t._v("公司新闻")]),t._v("\n    >\n    "),t.$route.query.articleid?i("span",{staticClass:"current-nav"},[t._v("编辑公司新闻")]):i("span",{staticClass:"current-nav"},[t._v("新增公司新闻")])]),t._v(" "),i("div",{staticClass:"article-content"},[i("div",{staticClass:"official-title-bar"},[t._v("公司新闻")]),t._v(" "),i("div",{staticClass:"editor-content"},[i("div",{staticClass:"editor-item article-type"},[t._m(0),t._v(" "),i("div",{staticClass:"item-right"},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.articleType,callback:function(e){t.articleType=e},expression:"articleType"}},t._l(t.articleTypeOption,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),t._v(" "),i("div",{staticClass:"editor-item article-title"},[t._m(1),t._v(" "),i("div",{staticClass:"item-right"},[i("el-input",{model:{value:t.articleTitle,callback:function(e){t.articleTitle=e},expression:"articleTitle"}})],1)]),t._v(" "),i("div",{staticClass:"editor-item article-content"},[t._m(2),t._v(" "),i("div",{staticClass:"item-right"},[i("tinymce",{ref:"editor",attrs:{height:260},model:{value:t.articleContent,callback:function(e){t.articleContent=e},expression:"articleContent"}})],1)])]),t._v(" "),i("el-dialog",{staticClass:"nopadding operate-dialog",attrs:{visible:t.sengTimeDialog,width:"600px",top:"35vh",center:""},on:{"update:visible":function(e){t.sengTimeDialog=e},close:t.closeHandler}},[i("div",{staticClass:"operate-content"},[i("div",{staticClass:"sent-title"},[t._v("定时发布")]),t._v(" "),i("div",{staticClass:"select-time"},[i("span",[t._v("发布时间")]),t._v(" "),i("el-date-picker",{attrs:{type:"datetime","picker-options":t.pickerOptions,placeholder:"选择日期时间"},model:{value:t.msgSengTime,callback:function(e){t.msgSengTime=e},expression:"msgSengTime"}})],1)]),t._v(" "),i("div",{staticClass:"btn-dialog",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"btn-Dialogok",on:{click:function(e){t.send(!0)}}},[t._v("确定")]),t._v(" "),i("div",{staticClass:"btn-Dialogcancel",on:{click:t.hideSengTimeDialog}},[t._v("取消")])])]),t._v(" "),i("div",{staticClass:"footer"},[t.isShowBtn?t._e():i("div",{staticClass:"send-gray-btn save-m-gradient",on:{click:t.cantSendTip}},[t._v("发布")]),t._v(" "),t.isShowBtn?i("div",{staticClass:"send-gray-btn save-m-gradient",on:{click:function(e){t.send(!1)}}},[t._v("发布")]):t._e(),t._v(" "),i("div",{staticClass:"cancel-btn",on:{click:t.cancel}},[t._v("取消")])])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("文章类型")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("文章标题")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("文章正文")])])}]};var u=i("C7Lr")(r,d,!1,function(t){i("KO84"),i("0Rht")},"data-v-b8c066b6",null);e.default=u.exports},KO84:function(t,e){},"Qhv/":function(t,e){},Rx1W:function(t,e){}});