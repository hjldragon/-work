webpackJsonp([30],{"5aCZ":function(t,e,i){"use strict";var s=i("rVsN"),n=i.n(s),a=i("ZLEe"),l=i.n(a),o=i("a2vD"),c={name:"editorSlideUpload",props:{color:{type:String,default:"#20a0ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],url:"./php/img_save.php",uploadData:{upload:1,userid:o.a.getUserid()},base_url:"./php"}},methods:{checkAllSuccess:function(){var t=this;return l()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=l()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var i=e.uid,s=l()(this.listObj),n=0,a=s.length;n<a;n++)if(this.listObj[s[n]].uid===i)return this.listObj[s[n]].url=t.files.file,void(this.listObj[s[n]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=l()(this.listObj),s=0,n=i.length;s<n;s++)if(this.listObj[i[s]].uid===e)return void delete this.listObj[i[s]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,s=t.uid;return this.listObj[s]={},new n.a(function(n,a){var l=new Image;l.src=i.createObjectURL(t),l.onload=function(){e.listObj[s]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},n(!0)})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{attrs:{icon:"upload",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("\n    上传图片\n  ")]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{action:t.url,data:t.uploadData,multiple:!0,name:"imgfile","file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var u={name:"tinymce",components:{editorImage:i("C7Lr")(c,r,!1,function(t){i("Qhv/")},"data-v-fad10c60",null).exports,SlUpload:i("GAg9").a},props:{id:{type:String},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return["styleselect removeformat undo redo |  bullist numlist | forecolor | bold italic blockquote | fullscreen code ","alignleft aligncenter alignright | link | fontsizeselect"]}},menubar:{default:""},height:{type:Number,required:!1,default:360},noImgupload:{type:Boolean,default:!1}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id||"vue-tinymce-"+ +new Date}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t)})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;console.log(window.tinymce),window.tinymce.init({selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body",object_resizing:!1,language:"zh_CN",toolbar:this.toolbar,menubar:this.menubar,plugins:"advlist,autolink,code,paste,textcolor, colorpicker,fullscreen,link,lists,media,wordcount, imagetools,image",end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["wpimg.wallstcn.com","wallstreetcn.com"],imagetools_toolbar:"watermark",default_link_target:"_blank",link_title:!1,formats:{},init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp",function(){t.hasChange=!0,t.$emit("input",i.getContent({format:"raw"}))})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},getImage:function(t){window.tinymce.get(this.tinymceId).insertContent('<img class="wscnph" src="http://platform'+window.full_url+"/php/img_get.php?img=1&imgname="+t+'" >')}},destroyed:function(){this.destroyTinymce()}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),e("div",{staticClass:"editor-custom-btn-container"},[this.noImgupload?this._e():e("sl-upload",{staticClass:"editor-upload-btn",attrs:{FreedomCrop:!0},on:{"send-image":this.getImage}})],1)])},staticRenderFns:[]};var m=i("C7Lr")(u,d,!1,function(t){i("Rx1W")},"data-v-4b3ba006",null);e.a=m.exports},HI4F:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("4YfN"),n=i.n(s),a=i("6ROu"),l=i.n(a),o=i("5aCZ"),c=i("a2vD"),r=i("9rMa"),u=i("6nXL"),d=i("P9l9"),m=i("swMD"),h={components:{Tinymce:o.a},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},sendTypeOption:[{label:u.K.toString(u.K.ALL),value:u.K.ALL},{label:u.K.toString(u.K.SHOP),value:u.K.SHOP},{label:u.K.toString(u.K.AGENT),value:u.K.AGENT}],businessStatusOption:[{label:"全部",value:4},{label:u.a.toString(u.a.NO),value:u.a.NO},{label:u.a.toString(u.a.DURING),value:u.a.DURING},{label:u.a.toString(u.a.SUC),value:u.a.SUC},{label:u.a.toString(u.a.FAIL),value:u.a.FAIL}],sendType:"",sendSTatus:"",msgTitle:"",msgContent:"",platformerid:c.a.getPlatformerid(),msgSengTime:"",sengTimeDialog:!1,newsid:"",isCanClick:!0}},computed:{isShowBtn:function(){return!!(this.sendType&&this.msgTitle&&this.msgContent&&'<p><br data-mce-bogus="1"></p>'!==this.msgContent&&0!==this.msgTitle.replace(/(^\s*)|(\s*$)/,"").length)}},created:function(){this.getnews()},beforeRouteEnter:function(t,e,i){i(function(t){t.SET_SELECTMENU({selectMenu:"/official/message/system"})})},beforeRouteLeave:function(t,e,i){this.SET_SELECTMENU({selectMenu:""}),i()},methods:n()({},Object(r.c)(["SET_SELECTMENU"]),{getnews:function(){var t=m.a.getItem("OFF-MESSAGE");t&&(this.msgTitle=t.title,this.msgContent=t.content,this.sendType=t.sendType,this.sendSTatus=t.sendSTatus)},openSengTimeDialog:function(){this.sengTimeDialog=!0},hideSengTimeDialog:function(){this.sengTimeDialog=!1},closeHandler:function(){this.msgSengTime=""},send:function(t){var e=this;if(""!==this.msgTitle)if(""!==this.sendSTatus)if(""!==this.msgContent)if(""!==this.sendType){var i={news_save:1,send_type:this.sendType,business_status:this.sendSTatus,title:this.msgTitle.trim(),content:this.msgContent,platfomer_id:this.platformerid};this.newsid&&(i.news_id=this.newsid),this.checkData()||(this.msgSengTime&&(i.send_time=parseInt(l()(this.msgSengTime).format("X"))),this.$slnotify({message:"正在发送,请稍等",duration:1e3}),this.isCanClick=!1,Object(d.Q)(i).then(function(t){0===t.ret?(e.$slnotify({message:"发布成功",duration:1e3}),setTimeout(function(){e.$router.push("/official/message/system"),e.isCanClick=!0},1e3)):t.ret===u.N.NEWS_IS_SEND?(e.$slnotify({message:"已发布消息不能编辑",duration:1e3}),e.isCanClick=!0):(e.$slnotify({message:u.N.toString(t.ret),duration:1e3}),e.isCanClick=!0)}))}else this.$slnotify({message:"请选择发送对象"});else this.$slnotify({message:"请输入内容"});else this.$slnotify({message:"请选择对象状态"});else this.$slnotify({message:"请输入公告标题"})},cantClick:function(){this.$slnotify({message:"正在发送,请稍等",duration:1e3})},goDetail:function(){this.$router.push("/officialmanage/systemdetail");var t={};t.title=this.msgTitle,t.content=this.msgContent,t.sendType=this.sendType,t.sendSTatus=this.sendSTatus,m.a.setItem("OFF-MESSAGE",t)},checkData:function(){var t=!1;this.msgSengTime&&(parseInt(l()(this.msgSengTime).format("x"))<Date.now()&&(t=!0,this.$slnotify({message:"设定的时间已经过期",duration:1e3})));return t},cancel:function(){this.$router.push("/official/message/system")}})},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"editore-article"}},[i("div",{staticClass:"nav-own-bar"},[i("span",{staticClass:"cant-click-nav"},[t._v("消息管理")]),t._v("\n       >\n       "),i("span",{staticClass:"can-click-nav",on:{click:t.cancel}},[t._v("公告管理")]),t._v("\n       >\n       "),i("span",{staticClass:"current-nav"},[t._v("新增公告")])]),t._v(" "),i("div",{staticClass:"edit-official-content"},[t._m(0),t._v(" "),i("div",{staticClass:"editor-content"},[i("div",{staticClass:"editor-item article-title"},[t._m(1),t._v(" "),i("div",{staticClass:"item-right"},[i("el-input",{model:{value:t.msgTitle,callback:function(e){t.msgTitle=e},expression:"msgTitle"}})],1)]),t._v(" "),i("div",{staticClass:"editor-item article-content"},[t._m(2),t._v(" "),i("div",{staticClass:"item-right"},[i("tinymce",{ref:"editor",attrs:{height:300},model:{value:t.msgContent,callback:function(e){t.msgContent=e},expression:"msgContent"}})],1)]),t._v(" "),i("div",{staticClass:"editor-item article-type item-inline"},[t._m(3),t._v(" "),i("div",{staticClass:"item-right"},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.sendType,callback:function(e){t.sendType=e},expression:"sendType"}},t._l(t.sendTypeOption,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),t._v(" "),i("div",{staticClass:"editor-item article-type item-inline"},[t._m(4),t._v(" "),i("div",{staticClass:"item-right"},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.sendSTatus,callback:function(e){t.sendSTatus=e},expression:"sendSTatus"}},t._l(t.businessStatusOption,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])]),t._v(" "),i("div",{staticClass:"footer"},[i("div",{staticClass:"of-btn-bd-b-blue margin-seven",on:{click:t.goDetail}},[t._v("预览")]),t._v(" "),t.isCanClick?i("div",{staticClass:"save-m-gradient margin-seven",on:{click:function(e){t.send(!1)}}},[t._v("发送")]):i("div",{staticClass:"save-m-gradient margin-seven",on:{click:function(e){t.cantClick(!1)}}},[t._v("发送")]),t._v(" "),i("div",{staticClass:"of-btn-bd-b-blue",on:{click:t.cancel}},[t._v("取消")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title clearfix"},[e("span",[this._v("发送消息列表")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("消息标题")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("消息正文")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("发送对象")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-left"},[e("span",{staticClass:"sl-must"},[this._v("对象状态")])])}]};var g=i("C7Lr")(h,f,!1,function(t){i("hQEK"),i("NnJl")},"data-v-0bb5ef56",null);e.default=g.exports},NnJl:function(t,e){},"Qhv/":function(t,e){},Rx1W:function(t,e){},hQEK:function(t,e){}});