webpackJsonp([53],{"+ywM":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("6CCb"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"staff-table"}},[s("div",{staticClass:"staff-tree change-tree-default"},[s("div",{staticClass:"change-tree-default",style:{height:t.height}},[s("el-tree",{ref:"tree",style:{height:t.height},attrs:{data:t.staffTree,props:t.defaultProps,"default-expand-all":"","highlight-current":t.isHighlight,"render-content":t.renderContent,"node-key":"label","default-current-key":"部门管理"},on:{"current-change":t.currentChange,"node-click":t.handleNodeClick,"node-expand":t.nodeExpand,"node-collapse":t.nodeExpand}})],1)]),t._v(" "),s("div",{staticClass:"staff-table",style:{height:t.height}},[s("div",{staticClass:"search-content"},[s("span",[t._v("姓名")]),t._v(" "),s("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),t._v(" "),s("span",[t._v("状态")]),t._v(" "),s("el-select",{model:{value:t.searchStatus,callback:function(e){t.searchStatus=e},expression:"searchStatus"}},t._l(t.statusArr,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),s("div",{staticClass:"search-btn",on:{click:t.searchMethods}},[t._v("搜索")])],1),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",height:t.tableHeight,data:t.staffList,stripe:""},on:{"sort-change":t.sort}},[s("el-table-column",{attrs:{prop:"platformer_id",label:"员工编号",align:"center","min-width":"10%",sortable:"true"}}),t._v(" "),s("el-table-column",{attrs:{prop:"pl_name",label:"姓名",align:"center","min-width":"10%","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"phone",label:"登录手机号",align:"center","min-width":"11%"}}),t._v(" "),s("el-table-column",{attrs:{prop:"pl_department_name",label:"部门",align:"center","min-width":"8%","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"pl_position_name",label:"职位",align:"center","min-width":"8%","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center","min-width":"20%","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.remark?s("span",{attrs:{size:"small","min-width":"20%"}},[t._v(t._s(e.row.remark)+"\n          ")]):s("span",{attrs:{size:"small"}},[t._v("--\n          ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"is_freeze",label:"状态",align:"center","min-width":"7%",sortable:"true"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_freeze===t.isNoFreezed?s("span",{attrs:{size:"small"}},[t._v("启用\n          ")]):s("span",{attrs:{size:"small"}},[t._v("冻结\n          ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作","min-width":"25%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_freeze===t.isNoFreezed?s("span",{staticClass:"text-red",attrs:{size:"small",type:"info"},on:{click:function(a){t.handleModifyStatus(e.row,1)}}},[t._v("冻结\n          ")]):s("span",{staticClass:"text-green",attrs:{size:"small",type:"success"},on:{click:function(a){t.handleModifyStatus(e.row,0)}}},[t._v("启用\n          ")]),t._v(" "),s("router-link",{attrs:{to:{path:"/organziteList/cantEditStaffDetail",query:{platformer_id:e.row.platformer_id,activIndex:"1",choosed_depart_id:t.choosedDepartId,choosed_depart_name:t.choosedDepartName}}}},[s("span",{staticClass:"text-blue",attrs:{size:"small",type:"text"}},[t._v("查看\n            ")])]),t._v(" "),s("router-link",{attrs:{to:{path:"/organziteList/editStaffDetail",query:{platformer_id:e.row.platformer_id,activIndex:"1",choosed_depart_id:t.choosedDepartId,choosed_depart_name:t.choosedDepartName}}}},[s("span",{staticClass:"text-blue",attrs:{size:"small",type:"text"}},[t._v("编辑\n            ")])]),t._v(" "),s("span",{staticClass:"text-red",attrs:{size:"small",type:"text"},on:{click:function(a){t.handleDeleteBtn(e.row)}}},[t._v("删除\n          ")])]}}])})],1),t._v(" "),s("div",{staticClass:"page"},[s("div",{staticClass:"pagination-content change-pagination-default"},[s("el-pagination",{staticClass:"page-el",attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,40],"page-size":t.listQuery.limit,layout:"sizes, jumper, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1)]),t._v(" "),t.isListEmpty?s("div",{staticClass:"data-empty"},[0==t.searchNone?s("div",{staticClass:"img"},[s("img",{attrs:{src:a("A+eB")}}),t._v(" "),s("div",{staticClass:"text-center"},[t._v("暂无数据...")])]):t._e(),t._v(" "),1==t.searchNone?s("div",{staticClass:"img"},[s("img",{attrs:{src:a("Fd8H")}}),t._v(" "),s("div",{staticClass:"text-center"},[t._v("暂无搜索数据...")])]):t._e()]):t._e()],1),t._v(" "),t.isOperate?s("operate-dialog",{attrs:{operateText:t.operateText,operateSuccessTxt:t.operateSuccessTxt,isShowRedBtn:t.isShowRedBtn,operateFailTxt:t.operateFailTxt},on:{dialogClose:t.dialogClose,confimOper:t.confimOper}}):t._e(),t._v(" "),t.isDetailDialog?s("detail-dialog",{attrs:{departmentName:t.departmentName,suOrfa:t.suOrfa,tipsText:t.tipsText,repeat:t.repeat},on:{confirmAdd:t.confirmAdd,handleClose:t.dialogClose}}):t._e()],1)},staticRenderFns:[]};var r=function(t){a("xSsE"),a("RORM")},n=a("C7Lr")(s.a,i,!1,r,"data-v-7316fe74",null);e.default=n.exports},"6CCb":function(t,e,a){"use strict";(function(t){var s=a("6nXL"),i=a("ihY9"),r=a("HPzi"),n=a("+vDi"),o=a("pMNc"),h=a("nMBb"),l=a("swMD"),d=a("CW5y");e.a={data:function(){return{newName:"",newDpaId:"",isOperate:!1,isListEmpty:!1,searchNone:!1,isDetailDialog:!1,suOrfa:!1,repeat:!1,isShowRedBtn:!1,isFreezeMethods:!1,isDeleDepart:!1,isSort:!1,sortLabel:"",sortOrder:1,height:0,tableHeight:0,depart_id:0,searchStatus:"",searchName:"",operateSuccessTxt:"",operateFailTxt:"",operateText:"",departmentName:"",tipsText:"",departmentId:"",operateStatus:null,operateData:{},total:0,listQuery:{page:1,limit:10},staffList:[],isHighlight:!0,staffTree:[{label:"部门管理",children:[]}],nameaa:"神奇的部落",treeNodeKey:"",statusArr:[{label:"全部",value:""},{label:s.n.toString(s.n.NO),value:s.n.NO},{label:s.n.toString(s.n.YES),value:s.n.YES}],treeDataArr:[],choosedDepartId:"",choosedDepartName:"",defaultProps:{label:"label",children:"children"}}},created:function(){var e=this;this.tableHeight=document.documentElement.clientHeight-274,this.height=document.documentElement.clientHeight-159+"px",t(window).resize(function(){e.height=document.documentElement.clientHeight-159+"px",e.tableHeight=document.documentElement.clientHeight-274}),this.listQuery.limit=d.a.get(this.$route),l.a.removeItem("#OFF_ORG_FORM"),this.getStaffTree(),void 0!==this.$route.query.choosedDepartId&&""!==this.$route.query.choosedDepartId?(this.choosedDepartId=this.$route.query.choosedDepartId,this.choosedDepartName=this.$route.query.choosedDepartName,this.getDepartStaff(this.$route.query.choosedDepartId)):(this.$nextTick(function(){e.newName=e.staffTree[0].label,e.$refs.tree.setCurrentKey(e.newName),e.isHighlight=!0}),this.getStaffListpl())},computed:{isNoFreezed:function(){return s.n.NO}},watch:{treeDataArr:function(t){var e=this;this.$nextTick(function(){e.$route.query.choosedDepartName&&(e.newName=e.$route.query.choosedDepartName,e.$refs.tree.setCurrentKey(e.newName),e.isHighlight=!0)})}},components:{operateDialog:n.a,detailDialog:h.a},methods:{getStaffListpl:function(){var t=this,e={get_platformer_list:1,page_size:this.listQuery.limit,page_no:this.listQuery.page};this.searchName&&(e.pl_name=this.searchName),(this.searchStatus||0===this.searchStatus)&&(e.is_freeze=this.searchStatus),this.isSort&&(e.sort_name=this.sortLabel,e.desc=this.sortOrder),this.depart_id&&(e.pl_department_id=this.depart_id),Object(i.e)(e).then(function(e){0===e.ret?e.data.platformer_list&&e.data.platformer_list.length>0?(t.staffList=e.data.platformer_list,t.isListEmpty=!1,t.total=e.data.total):(t.staffList=[],t.total=0,t.isListEmpty=!0,!0===t.isSearch?t.searchNone=!0:t.searchNone=!1):t.$slnotify({message:s.C.toString(e.ret)})}),this.staffList=[]},getStaffTree:function(){this.staffTree[0].children=Object(r.c)(),this.treeDataArr=this.staffTree[0].children},getDepartStaff:function(t){var e=this;this.searchName="",this.searchStatus="";var a={get_department_platformer:1,page_size:this.listQuery.limit,page_no:this.listQuery.page,pl_department_id:t};Object(i.a)(a).then(function(t){0===t.ret?(t.data.platformer_list&&t.data.platformer_list.length>0?(e.staffList=t.data.platformer_list,e.isListEmpty=!1):(e.staffList=[],e.isListEmpty=!0,!0===e.isSearch?e.searchNone=!0:e.searchNone=!1),e.isSearch=!1):e.$slnotify({message:s.C.toString(t.ret)})})},sort:function(t){this.sortLabel=t.prop,"descending"===t.order?(this.isSort=!0,this.sortOrder=-1):"ascending"===t.order?(this.isSort=!0,this.sortOrder=1):this.isSort=!1,this.searchName="",this.searchStatus="",this.getStaffListpl()},FreezeStaffMethods:function(){var t=this,e={platformer_freeze:1,platformer_id:this.operateData.platformer_id,is_freeze:this.operateStatus};Object(i.f)(e).then(function(e){0===e.ret?(t.operateStatus!==t.isNoFreezed?(t.operateSuccessTxt="冻结成功",t.suOrfa=!1):t.operateSuccessTxt="启用成功",t.isFreezeMethods=!1):t.$slnotify({message:s.C.toString(e.ret)})}),this.searchName="",this.searchStatus="",this.getStaffListpl()},deleteStaffMethods:function(){var t=this,e={platformer_del:1,platformer_id:this.operateData.platformer_id};Object(i.f)(e).then(function(e){0===e.ret?t.operateSuccessTxt="删除成功":t.$slnotify({message:s.C.toString(e.ret)})}),this.searchName="",this.searchStatus="",this.getStaffListpl()},deleteDepartMethods:function(){var t=this,e={pl_department_del:1,pl_department_id:this.operateData.pl_department_id};Object(i.b)(e).then(function(e){0===e.ret?(t.operateSuccessTxt="删除成功",t.suOrfa=!1,t.newName="",t.depart_id="",t.choosedDepartId="",t.choosedDepartName="",t.getStaffTree()):-30033===e.ret?(t.operateFailTxt="该条目下包含数据，不能被删除",t.getStaffTree(),t.newName=t.treeNodeKey,t.getDepartStaff(t.depart_id)):t.$slnotify({message:s.C.toString(e.ret)}),t.isDeleDepart=!0})},handleSelect:function(t){this.activeIndex=t},currentChange:function(){this.isHighlight=!0},nodeExpand:function(t,e){this.isHighlight=!0;var a=e.key;this.$refs.tree.setCurrentKey(a),this.isSearch=!1,this.listQuery.page=1,this.choosedDepartId=e.data.pl_department_id,e.childNodes&&0===e.childNodes.length?(this.getDepartStaff(e.data.pl_department_id),this.choosedDepartId=e.data.pl_department_id):(this.choosedDepartId="",this.searchName="",this.searchStatus="",this.getStaffListpl())},handleNodeClick:function(t,e){this.isHighlight=!0,this.isSearch=!1,this.listQuery.page=1,this.newName=t.label,this.depart_id=t.pl_department_id,this.treeNodeKey=e.key,e.childNodes&&0===e.childNodes.length?(this.getDepartStaff(e.data.pl_department_id),this.choosedDepartId=t.pl_department_id,this.choosedDepartName=e.key):(this.$router.replace("/organzite/list"),this.choosedDepartId="",this.choosedDepartName="",this.searchName="",this.searchStatus="",this.getStaffListpl())},searchMethods:function(){this.isSearch=!0,this.listQuery.page=1,this.getStaffListpl()},handleSizeChange:function(t){this.listQuery.limit=t,this.getStaffListpl(),d.a.set(this.$route,t)},handleCurrentChange:function(t){this.listQuery.page=t,this.getStaffListpl()},handleModifyStatus:function(t,e){this.isFreezeMethods=!0,e!==this.isNoFreezed?(this.operateText="确定执行冻结操作？",this.isShowRedBtn=!0):(this.operateText="确定执行启用操作？",this.isShowRedBtn=!1),this.isOperate=!this.isOperate,this.operateStatus=e,this.operateData=t,this.isDeleDepart=!1,this.searchName="",this.searchStatus=""},addNewPosition:function(){this.isDetailDialog=!this.isDetailDialog},confirmAdd:function(t){var e=this;this.tipsText="新建成功!";var a={pl_department_save:1,pl_department_name:t};this.newName=t,this.departmentId&&""!==this.departmentId&&(a.pl_department_id=this.departmentId,this.tipsText="修改成功!"),this.newName=t,Object(i.b)(a).then(function(t){0===t.ret?(e.newDpaId=t.data.pl_department_id,e.depart_id=e.newDpaId,e.suOrfa=!1,e.repeat=!1,e.getStaffTree()):-20034===t.ret?(e.suOrfa=!0,e.repeat=!0):e.$slnotify({message:s.C.toString(t.ret)})})},dialogClose:function(){this.operateText="",this.operateSuccessTxt="",this.operateFailTxt="",this.isOperate=!1,this.isDetailDialog=!1,this.depart_id?(this.getDepartStaff(this.depart_id),this.choosedDepartId=this.depart_id):(this.choosedDepartId="",this.newName=this.staffTree[0].label,this.searchName="",this.searchStatus="",this.getStaffListpl()),this.$refs.tree.setCurrentKey(this.newName),this.isHighlight=!0},confimOper:function(){this.isFreezeMethods&&!this.isDeleDepart?this.FreezeStaffMethods():this.isFreezeMethods||this.isDeleDepart?this.isDeleDepart&&(this.deleteDepartMethods(),this.isDeleDepart=!1):this.deleteStaffMethods(),this.searchName="",this.searchStatus=""},handleDeleteBtn:function(t){this.operateData=t,this.operateText="确定删除此数据？",this.isShowRedBtn=!0,this.isOperate=!this.isOperate,this.searchName="",this.searchStatus="",this.isDeleDepart=!1},renderContent:function(t,e){var a=e.node,s=e.data,i=e.store,r=this;return t(o.a,{props:{DATA:s,NODE:a,STORE:i},on:{nodeAdd:function(t,e,a){return r.handleAdd(t,e,a)},nodeEdit:function(t,e,a){return r.handleEdit(t,e,a)},nodeDel:function(t,e,a){return r.handleDelete(t,e,a)}}})},handleAdd:function(t,e,a){this.suOrfa=!0,this.repeat=!1,a.data.pl_department_id?this.$router.push({path:"/organzite/create",query:{choosed_depart_id:this.choosedDepartId,choosed_depart_name:this.choosedDepartName}}):(this.departmentName="",a.expanded||(a.expanded=!0),this.depart_id="",this.isDetailDialog=!this.isDetailDialog)},handleEdit:function(t,e,a){this.suOrfa=!0,this.departmentName=a.data.label,this.departmentId=a.data.pl_department_id,this.isDetailDialog=!this.isDetailDialog,this.treeNodeKey=a.data.label},handleDelete:function(t,e,a){this.treeNodeKey=a.data.label,this.operateData=a.data,this.operateText="确定删除此部门？",this.isShowRedBtn=!0,this.isOperate=!this.isOperate,this.isDeleDepart=!0}}}}).call(e,a("L7Pj"))},RORM:function(t,e){},xSsE:function(t,e){}});