webpackJsonp([60],{NloM:function(o,i,t){"use strict";(function(o){var s=t("6j3y"),r=t("Ta7z"),e=t("b5mr"),n=t("9aGi"),a=t("USo7"),c=t("6nXL"),h=t("N6PA");i.a={data:function(){var o=this;return{height:0,userId:"",isCantClick:!0,imgbase_url:"./php",isShowBigImg:!1,showImg:!1,isImg:!1,isSelectError:!1,cityinfo:{province:"",city:"",area:""},canotChangeSrc:"",basicInfroForm:{shop_logo:"",shop_name:"",telephone:"",shop_area:"",address:"",suportType:"简餐",flooerNo:"",fullAddress:"",shop_id:""},isShowMap:!1,rules:{shop_logo:[{required:!0,validator:function(i,t,s){if(!o.basicInfroForm.shop_logo)return s(new Error("请上传店铺Logo"));s()},trigger:"change"}],shop_name:[{required:!0,validator:function(o,i,t){var s=h.a.isSpacebar(i);""===i?t(new Error("请输入店铺名称")):s?t(new Error("店铺名称不能包含空格符")):t()},trigger:"change,input"}],telephone:[{required:!0,validator:function(o,i,t){var s=h.a.isLandLinePhone(i);return i?s?void t():t(new Error("请输入合法的电话号码")):t(new Error("请输入电话号码"))},trigger:"change,input"}],shop_area:[{required:!0,validator:function(o,i,t){var s=h.a.isShopArea(i);return i?isNaN(i)?t(new Error("请输入有效的店铺面积")):s?void t():t(new Error("请输入有效的店铺面积(最多保留两位小数)")):t(new Error("请输入店铺面积"))},trigger:"change,input"}]}}},created:function(){var i=this;this.height=document.documentElement.clientHeight-146+"px",o(window).resize(function(){i.height=document.documentElement.clientHeight-146+"px"}),this.$route.query.shopId&&this.getFormData()},components:{citySelect:n.a,codeImg:e.a,ImgUpload:s.a,MapComponent:r.a},computed:{bussNodel:function(){return c.A},signTypeRe:function(){return c.t.REGION}},methods:{getFormData:function(){var o=this;this.basicInfroForm.shop_id=this.$route.query.shopId||"";var i={get_shop_info:1,shop_id:this.$route.query.shopId};Object(a.e)(i).then(function(i){0===i.ret&&(o.basicInfroForm=i.data.shopinfo,o.canotChangeSrc=i.data.shopinfo.shop_logo,o.basicInfroForm.shop_id=i.data.shopinfo.shop_id,o.userId=i.data.shopinfo.userid,o.basicInfroForm.flooerNo=i.data.shopinfo.address,o.cityinfo.province=i.data.shopinfo.province,o.cityinfo.city=i.data.shopinfo.city,o.cityinfo.area=i.data.shopinfo.area,o.isShowBigImg=!0,""!==o.basicInfroForm.shop_logo&&(o.isImg=!0),o.inputFloorNo(),""!==o.basicInfroForm.shop_name&&""!==o.basicInfroForm.telephone&&""!==o.basicInfroForm.shop_area&&o.basicInfroForm.address&&o.basicInfroForm.shop_model&&""!==o.basicInfroForm.shop_logo&&""!==o.basicInfroForm.flooerNo?(o.checkFinishInput("basicInfroForm"),o.isCantClick=!1):o.isCantClick=!0)})},changeProvinces:function(o){this.cityinfo.province=o.province,this.cityinfo.city=o.city,this.cityinfo.area=o.blocks,""===this.cityinfo.province||""===this.cityinfo.city||""===this.cityinfo.area||""===this.basicInfroForm.flooerNo?(this.isSelectError=!0,this.isCantClick=!0):(this.isSelectError=!1,this.isCantClick=!1),this.basicInfroForm.fullAddress=this.cityinfo.province+this.cityinfo.city+this.cityinfo.area+this.basicInfroForm.flooerNo,this.basicInfroForm.flooerNo=""},inputFloorNo:function(){""===this.cityinfo.province||""===this.cityinfo.city||""===this.cityinfo.area||""===this.basicInfroForm.flooerNo?(this.isSelectError=!0,this.isCantClick=!0):(this.isSelectError=!1,this.isCantClick=!1,this.basicInfroForm.fullAddress=this.cityinfo.province+this.cityinfo.city+this.cityinfo.area+this.basicInfroForm.flooerNo)},checkFinishInput:function(o){var i=this;""===this.basicInfroForm.flooerNo&&(this.isCantClick=!1),this.$refs[o].validate(function(o){i.isCantClick=!o})},getPhoto:function(o){this.basicInfroForm.shop_logo=o,""!==this.basicInfroForm.shop_name&&""!==this.basicInfroForm.telephone&&""!==this.basicInfroForm.shop_area&&this.basicInfroForm.address&&this.basicInfroForm.shop_model&&""!==this.basicInfroForm.shop_logo&&""!==this.basicInfroForm.flooerNo&&(this.checkFinishInput("basicInfroForm"),this.saveInfo()),this.isShowBigImg=!0,this.isImg=!0},clickImg:function(){this.showImg=!0,this.isImg=!0,this.basicInfroForm.shop_logo=this.basicInfroForm.shop_logo},viewImg:function(){this.showImg=!1},showMapView:function(){this.isShowMap=!0},openMap:function(){this.isShowMap=!0},closeMap:function(){this.isShowMap=!1,this.inputFloorNo()},getFormAddress:function(o){this.cityinfo.province=o.province,this.cityinfo.city=o.city,this.cityinfo.area=o.district,this.basicInfroForm.flooerNo=o.street+o.streetNumber,this.basicInfroForm.address=o,this.inputFloorNo()},saveInfo:function(){var o=this,i={shop_save:1,shop_userid:this.userId,shop_id:this.basicInfroForm.shop_id,shop_name:this.basicInfroForm.shop_name,shop_logo:this.basicInfroForm.shop_logo,shop_area:Number(this.basicInfroForm.shop_area),address:this.basicInfroForm.flooerNo,shop_model:1,telephone:this.basicInfroForm.telephone,province:this.cityinfo.province,city:this.cityinfo.city,area:this.cityinfo.area};Object(a.f)(i).then(function(t){0===t.ret?(o.$slnotify({message:"保存成功"}),o.$router.push({path:"/merchantlist/editMerchantDetail",query:{merchantInfo:o.basicInfroForm.shop_id}})):-10006===t.ret?(o.$slnotify({message:"该登录手机号已被占用"}),o.isCantClick=!0):-30043===t.ret&&(o.$slnotify({message:"图片更换不到一个月"}),o.basicInfroForm.shop_logo=o.canotChangeSrc,Object(a.f)(i))})},cancelInfo:function(){this.$router.push({path:"/merchantlist/editMerchantDetail",query:{merchantInfo:this.basicInfroForm.shop_id}})}}}}).call(i,t("L7Pj"))},aFnG:function(o,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t("NloM"),r={render:function(){var o=this,i=o.$createElement,t=o._self._c||i;return t("div",{attrs:{id:"basic-info"}},[t("div",{staticClass:"header"},[t("p",[t("router-link",{attrs:{to:{path:"/merchant/list"}}},[t("span",{staticClass:"black"},[o._v("商户列表")])]),o._v(" "),t("span",{staticClass:"text-green"},[o._v(">")]),o._v(" "),t("router-link",{attrs:{to:{path:"/merchantlist/editMerchantDetail",query:{merchantInfo:o.basicInfroForm.shop_id}}}},[t("span",{staticClass:"black"},[o._v("商户详情")])]),o._v(" "),t("span",{staticClass:"text-green"},[o._v(">")]),o._v(" "),t("span",{staticClass:"text-green"},[o._v("编辑基础信息")])],1)]),o._v(" "),t("div",{staticClass:"basic-info"},[o._m(0),o._v(" "),t("div",{staticClass:"info-board",style:{height:o.height}},[t("el-form",{ref:"basicInfroForm",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:o.basicInfroForm,rules:o.rules}},[t("el-form-item",{attrs:{label:"店铺名称",prop:"shop_name"}},[t("el-input",{attrs:{placeholder:"请输入店铺名称"},on:{input:function(i){o.checkFinishInput("basicInfroForm")}},model:{value:o.basicInfroForm.shop_name,callback:function(i){o.$set(o.basicInfroForm,"shop_name",i)},expression:"basicInfroForm.shop_name"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"店铺Logo",prop:"shop_logo"}},[o.isShowBigImg?t("div",{staticClass:"logoImg float-left"},[o.isImg?t("div",{staticClass:"img left"},[t("div",{staticClass:"mask"}),o._v(" "),t("img",{attrs:{src:o.imgbase_url+"/img_get.php?img=1&height=100&width=100&imgname="+o.basicInfroForm.shop_logo,alt:""}}),o._v(" "),t("i",{staticClass:"el-icon-zoom-in",on:{click:o.clickImg}})]):o._e()]):o._e(),o._v(" "),o.showImg?t("code-img",{attrs:{imgSrc:o.basicInfroForm.shop_logo},on:{clickit:o.viewImg}}):o._e(),o._v(" "),t("img-upload",{staticClass:"float-left",on:{"send-image":o.getPhoto,change:function(i){o.checkFinishInput("basicInfroForm")}}}),o._v(" "),t("div",{staticClass:"text-warp float-left"},[t("p",{staticClass:"text"},[o._v("一个月内只能更换一次,文件类型必须为JPG、JPEG、PNG,文件大小不超过1M")])])],1),o._v(" "),t("el-form-item",{attrs:{label:"店铺电话",prop:"telephone"}},[t("el-input",{attrs:{placeholder:"请输入店铺电话"},on:{input:function(i){o.checkFinishInput("basicInfroForm")}},model:{value:o.basicInfroForm.telephone,callback:function(i){o.$set(o.basicInfroForm,"telephone",i)},expression:"basicInfroForm.telephone"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"店铺面积",prop:"shop_area"}},[t("el-input",{attrs:{placeholder:"请输入店铺面积"},on:{input:function(i){o.checkFinishInput("basicInfroForm")}},model:{value:o.basicInfroForm.shop_area,callback:function(i){o.$set(o.basicInfroForm,"shop_area",i)},expression:"basicInfroForm.shop_area"}}),o._v(" "),t("span",{staticClass:"black"},[o._v("m²")])],1),o._v(" "),t("el-form-item",{class:{"is-error":o.isSelectError},attrs:{label:"店铺地址"}},[t("city-select",{staticClass:"city-select",attrs:{isSelectError:o.isSelectError,cityinfo:o.cityinfo},on:{changeProvinces:o.changeProvinces}}),o._v(" "),t("span",{staticClass:"map-icon",on:{click:o.showMapView}}),o._v(" "),t("div",[t("el-input",{attrs:{placeholder:"街道楼盘名称房号"},on:{input:o.inputFloorNo,blur:o.inputFloorNo,change:function(i){o.checkFinishInput("basicInfroForm")}},model:{value:o.basicInfroForm.flooerNo,callback:function(i){o.$set(o.basicInfroForm,"flooerNo",i)},expression:"basicInfroForm.flooerNo"}})],1),o._v(" "),o.isSelectError?t("p",{staticClass:"error"},[o._v("请输入街道楼盘名称房号")]):o._e()],1),o._v(" "),t("el-form-item",{attrs:{label:"营业模式"}},[o.basicInfroForm.shop_model===o.bussNodel.FASTFOOD?t("span",{staticClass:"simple"},[o._v("简餐")]):o.basicInfroForm.shop_model===o.bussNodel.CHINESEFOOD?t("span",{staticClass:"simple"},[o._v("中餐")]):t("span",{staticClass:"simple"},[o._v(" --")])])],1),o._v(" "),t("div",{staticClass:"btn-group"},[o.isCantClick?t("div",{staticClass:"save-btn cant-click"},[o._v("保存")]):t("div",{staticClass:"save-btn",on:{click:o.saveInfo}},[o._v("保存")]),o._v(" "),t("div",{staticClass:"cancel-btn",on:{click:o.cancelInfo}},[o._v("取消")])])],1)]),o._v(" "),t("keep-alive",[o.isShowMap?t("map-component",{attrs:{province:o.cityinfo.province,city:o.cityinfo.city,district:o.cityinfo.district,street:o.basicInfroForm.flooerNo},on:{"on-close":o.closeMap,"get-address":o.getFormAddress}}):o._e()],1)],1)},staticRenderFns:[function(){var o=this.$createElement,i=this._self._c||o;return i("div",{staticClass:"title-bar"},[i("span",{staticClass:"text-strong"},[this._v("基础信息")])])}]};var e=function(o){t("tt65"),t("vRtS")},n=t("C7Lr")(s.a,r,!1,e,"data-v-59612e24",null);i.default=n.exports},tt65:function(o,i){},vRtS:function(o,i){}});