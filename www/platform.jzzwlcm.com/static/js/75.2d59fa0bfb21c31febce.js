webpackJsonp([75],{"/c3C":function(e,t){},Oh3o:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("fwzn"),i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"staff-creat-area"}},[r("div",{staticClass:"header"},[r("p",[r("span",{staticClass:"black",on:{click:e.cancelInfo}},[e._v("员工管理")]),e._v(" "),r("span",{staticClass:"text-green"},[e._v(">")]),e._v(" "),e.$route.query.ag_employee_id?r("span",{staticClass:"text-green"},[e._v("编辑员工信息")]):r("span",{staticClass:"text-green"},[e._v("创建员工")])])]),e._v(" "),r("div",{staticClass:"basic-info",style:{height:e.height}},[r("div",{staticClass:"title-bar"},[e.$route.query.ag_employee_id?r("span",{staticClass:"text-strong"},[e._v("编辑员工信息")]):r("span",{staticClass:"text-strong"},[e._v("创建员工")])]),e._v(" "),r("div",{staticClass:"info-bord"},[r("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm2,rules:e.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"real_name"}},[r("el-input",{attrs:{placeholder:"请输入员工姓名"},on:{input:function(t){e.checkFinishInput("ruleForm2")}},model:{value:e.ruleForm2.real_name,callback:function(t){e.$set(e.ruleForm2,"real_name",e._n(t))},expression:"ruleForm2.real_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录手机号",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入登录手机号"},on:{input:function(t){e.checkFinishInput("ruleForm2")}},model:{value:e.ruleForm2.phone,callback:function(t){e.$set(e.ruleForm2,"phone",e._n(t))},expression:"ruleForm2.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录密码",prop:"password"}},[r("el-input",{attrs:{type:"password",id:"type-pass-word","auto-complete":"off",placeholder:"请输入密码"},on:{input:function(t){e.checkFinishInput("ruleForm2")}},model:{value:e.ruleForm2.password,callback:function(t){e.$set(e.ruleForm2,"password",t)},expression:"ruleForm2.password"}},[r("i",{staticClass:"iconfont ",class:{"icon-yanjing":e.typePass,"icon-yanjing1":!e.typePass},attrs:{slot:"suffix"},on:{click:e.cantSeePass},slot:"suffix"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"确认登录密码",prop:"checkPass"}},[r("el-input",{attrs:{type:"password",id:"type-text-word","auto-complete":"off",placeholder:"请确认登录密码"},on:{input:function(t){e.checkFinishInput("ruleForm2")}},model:{value:e.ruleForm2.checkPass,callback:function(t){e.$set(e.ruleForm2,"checkPass",t)},expression:"ruleForm2.checkPass"}},[r("i",{staticClass:"iconfont",class:{"icon-yanjing":e.typeText,"icon-yanjing1":!e.typeText},attrs:{slot:"suffix"},on:{click:e.canSeePass},slot:"suffix"})])],1),e._v(" "),r("el-form-item",{staticClass:"selct-box",attrs:{label:"职位",prop:"ag_position_name"}},[r("el-select",{attrs:{placeholder:"请选择职位"},on:{change:function(t){e.checkPosition("ruleForm2")}},model:{value:e.ruleForm2.ag_position_name,callback:function(t){e.$set(e.ruleForm2,"ag_position_name",t)},expression:"ruleForm2.ag_position_name"}},e._l(e.positionArr,function(e){return r("el-option",{key:e.ag_position_id,attrs:{label:e.label,value:e.ag_position_id}})})),e._v(" "),r("div",{staticClass:"add-new-position",on:{click:e.addNewPositionMethods}},[e._v("新增职位")])],1),e._v(" "),r("el-form-item",{staticClass:"selct-box",attrs:{label:"部门",prop:"ag_department_name"}},[r("el-select",{attrs:{placeholder:"请选择部门"},on:{change:function(t){e.checkDepart("ruleForm2")}},model:{value:e.ruleForm2.ag_department_name,callback:function(t){e.$set(e.ruleForm2,"ag_department_name",t)},expression:"ruleForm2.ag_department_name"}},e._l(e.departmentArr,function(e){return r("el-option",{key:e.ag_department_id,attrs:{label:e.label,value:e.ag_department_id}})})),e._v(" "),r("div",{staticClass:"add-new-position",on:{click:e.addNewPosition}},[e._v("新增部门")])],1),e._v(" "),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入备注，字数不超过150字",maxlength:150},model:{value:e.ruleForm2.remark,callback:function(t){e.$set(e.ruleForm2,"remark",t)},expression:"ruleForm2.remark"}})],1)],1),e._v(" "),r("div",{staticClass:"btn-group"},[e.isCantClick?r("div",{staticClass:"save-btn cant-click"},[e._v("保存")]):r("div",{staticClass:"save-btn",on:{click:e.saveInfo}},[e._v("保存")]),e._v(" "),r("div",{staticClass:"cancel-btn",on:{click:e.cancelInfo}},[e._v("取消")])])],1)]),e._v(" "),e.isDetailDialog?r("detail-dialog",{attrs:{departmentName:e.departmentName,suOrfa:e.suOrfa,tipsText:e.tipsText,repeat:e.repeat},on:{confirmAdd:e.confirmAdd,handleClose:e.handleClose}}):e._e()],1)},staticRenderFns:[]};var o=function(e){r("/c3C"),r("RfDX")},s=r("C7Lr")(a.a,i,!1,o,"data-v-29d3b84d",null);t.default=s.exports},RfDX:function(e,t){},fwzn:function(e,t,r){"use strict";(function(e){var a=r("Xtis"),i=r("nMBb"),o=r("swMD"),s=r("a2vD"),n=r("6nXL"),l=r("N6PA"),u=r("p77j");t.a={data:function(){var e=this;return{typeText:!1,typePass:!1,isCantClick:!0,isDetailDialog:!1,suOrfa:!0,repeat:!1,departmentName:"",tipsText:"",ruleForm2:{password:"",checkPass:"",phone:"",real_name:"",sex:"",remark:"",ag_position_name:"",ag_department_name:"",department_id:"",position_id:"",userId:""},position_id:"",department_id:"",agentId:"",positionArr:[],departmentArr:[],rules:{password:[{required:!0,validator:function(t,r,a){var i=l.a.isPassWord(r);""===r?a(new Error("请输入密码")):(i||(e.isCantClick=!0,a(new Error("密码格式必须可以是字母、数字，不能使用特殊字符，长度在6-20之间"))),""!==e.ruleForm2.checkPass&&e.$refs.ruleForm2.validateField("checkPass"),a())},trigger:"change,input,blur"}],checkPass:[{required:!0,validator:function(t,r,a){""===r?a(new Error("请再次输入密码")):r!==e.ruleForm2.password?a(new Error("两次输入密码不一致!")):a()},trigger:"change,input,blur"}],phone:[{required:!0,validator:function(t,r,a){var i=l.a.isTelePhone(r);return r?i?void a():(e.isCantClick=!0,a(new Error("请输入合法的电话号码"))):a(new Error("请输入电话号码"))},trigger:"change,input,blur"}],real_name:[{required:!0,validator:function(t,r,a){var i=l.a.isPersonName(r);""===r?a(new Error("请输入联系人姓名")):i?a():(e.isCantClick=!0,a(new Error("姓名格式可为中英文，不包括特殊数字和字符")))},trigger:"change,input,blur"}],ag_position_name:[{required:!0,validator:function(t,r,a){""===e.ruleForm2.ag_position_name?a(new Error("请选择职位")):a()},trigger:"change,blur"}],ag_department_name:[{required:!0,validator:function(t,r,a){""===e.ruleForm2.ag_department_name?a(new Error("请选择部门")):a()},trigger:"change,blur"}]}}},created:function(){var t=this;this.height=document.documentElement.clientHeight-110+"px",e(window).resize(function(){t.height=document.documentElement.clientHeight-110+"px"}),this.agentId=s.a.getAgentid(),this.getDepartPosiArr(),this.$nextTick(function(){o.a.getItem("OFF_AREA_FORM")?(t.saveEditData(),t.staffId=t.$route.query.ag_employee_id||""):t.$route.query.ag_employee_id&&""!==t.$route.query.ag_employee_id&&t.getForm()}),this.$route.query.choosed_depart_id&&this.$route.query.choosed_depart_name&&(this.department_id=this.$route.query.choosed_depart_id,this.ruleForm2.department_id=this.$route.query.choosed_depart_id,this.ruleForm2.ag_department_name=this.$route.query.choosed_depart_name)},computed:{},components:{detailDialog:i.a},methods:{getForm:function(){var e=this;this.$route.query.ag_employee_id&&""!==this.$route.query.ag_employee_id&&(o.a.removeItem("OFF_AREA_FORM"),this.staffId=this.$route.query.ag_employee_id||"");var t={get_ag_employee_info:1,ag_employee_id:this.staffId};Object(a.a)(t).then(function(t){0===t.ret?(e.ruleForm2=t.data.agemployee,e.ruleForm2.checkPass=t.data.agemployee.password,e.department_id=e.ruleForm2.ag_department_id,e.ruleForm2.department_id=e.ruleForm2.ag_department_id,e.position_id=e.ruleForm2.ag_position_id,e.$route.query.positionName&&(e.ruleForm2.ag_position_name=e.$route.query.positionName,e.position_id=e.$route.query.ag_position_id),""!==e.ruleForm2.password&&""!==e.ruleForm2.checkPass&&""!==e.ruleForm2.phone&&""!==e.ruleForm2.real_name&&""!==e.ruleForm2.ag_position_name&&""!==e.ruleForm2.ag_department_name?e.isCantClick=!1:e.isCantClick=!0):e.$slnotify({message:n.C.toString(t.ret)})})},saveEditData:function(){this.ruleForm2=o.a.getItem("OFF_AREA_FORM"),this.department_id=this.ruleForm2.department_id,this.$route.query.positionName?(this.ruleForm2.ag_position_name=this.$route.query.positionName,this.position_id=this.$route.query.ag_position_id,this.ruleForm2.position_id=this.$route.query.ag_position_id):this.position_id=this.ruleForm2.position_id,""!==this.ruleForm2.password&&""!==this.ruleForm2.checkPass&&""!==this.ruleForm2.phone&&""!==this.ruleForm2.real_name&&""!==this.ruleForm2.ag_position_name&&""!==this.ruleForm2.ag_department_name?this.isCantClick=!1:this.isCantClick=!0},getDepartPosiArr:function(){this.departmentArr=Object(u.b)(),this.positionArr=Object(u.c)()},addNewPosition:function(){this.isDetailDialog=!this.isDetailDialog},confirmAdd:function(e){var t=this;this.tipsText="新建成功!";var r={ag_department_save:1,agent_id:this.agentId,ag_department_name:e};Object(a.h)(r).then(function(r){0===r.ret?(t.suOrfa=!1,t.repeat=!1,t.departmentArr=Object(u.b)(),t.ruleForm2.ag_department_name=e,t.department_id=r.data.ag_department_id,t.ruleForm2.department_id=r.data.ag_department_id,""!==t.ruleForm2.password&&""!==t.ruleForm2.checkPass&&""!==t.ruleForm2.phone&&""!==t.ruleForm2.real_name&&""!==t.ruleForm2.ag_position_name&&""!==t.ruleForm2.ag_department_name?t.checkFinishInput("ruleForm2"):t.isCantClick=!0):-20034===r.ret?(t.suOrfa=!0,t.repeat=!0):t.$slnotify({message:n.C.toString(r.ret)})})},handleClose:function(){this.suOrfa=!0,this.isDetailDialog=!1,this.checkFinishInput("ruleForm2")},addNewPositionMethods:function(){o.a.setItem("OFF_AREA_FORM",this.ruleForm2),this.suOrfa=!0,this.$router.push({path:"/areaOrganziteList/positionDetail",query:{form:this.ruleForm2,ag_position_id:this.position_id,ag_employee_id:this.staffId,choosed_depart_name:this.$route.query.choosed_depart_name,choosed_depart_id:this.$route.query.choosed_depart_id,position_name:this.ruleForm2.ag_position_name,pathName:"/areaOrganziteList/staffDetail"}})},checkPosition:function(e){this.position_id=this.ruleForm2.ag_position_name,this.checkFinishInput(e)},checkDepart:function(e){this.department_id=this.ruleForm2.ag_department_name,this.ruleForm2.department_id=this.ruleForm2.ag_department_name,this.checkFinishInput(e)},checkFinishInput:function(e){var t=this;""!==this.ruleForm2.password&&""!==this.ruleForm2.checkPass&&""!==this.ruleForm2.phone&&""!==this.ruleForm2.real_name&&""!==this.ruleForm2.ag_position_name&&""!==this.ruleForm2.ag_department_name?this.$refs[e].validate(function(e){t.isCantClick=!e}):this.isCantClick=!0},saveInfo:function(){var e=this;this.checkFinishInput("ruleForm2");var t={ag_employee_save:1,agent_id:this.agentId,real_name:this.ruleForm2.real_name,phone:this.ruleForm2.phone,password:this.ruleForm2.password,re_password:this.ruleForm2.checkPass,remark:this.ruleForm2.remark,ag_position_id:this.position_id,ag_department_id:this.department_id};this.$route.query.ag_employee_id&&(t.ag_employee_id=this.$route.query.ag_employee_id),Object(a.b)(t).then(function(t){o.a.removeItem("OFF_AREA_FORM"),0===t.ret?e.$router.push({path:"/areaagent/organize",query:{activIndex:"1",choosedDepartId:e.$route.query.choosed_depart_id,choosedDepartName:e.$route.query.choosed_depart_name}}):-10006===t.ret||-10026===t.ret?e.$slnotify({message:"该手机号码已被注册"}):e.$slnotify({message:n.C.toString(t.ret)})})},cancelInfo:function(){o.a.removeItem("OFF_AREA_FORM"),this.$router.push({path:"/areaagent/organize",query:{activIndex:"1",choosedDepartId:this.$route.query.choosed_depart_id,choosedDepartName:this.$route.query.choosed_depart_name}})},canSeePass:function(){this.typeText=!this.typeText,this.typeText?document.getElementById("type-text-word").type="passWord":document.getElementById("type-text-word").type="text"},cantSeePass:function(){this.typePass=!this.typePass,this.typePass?document.getElementById("type-pass-word").type="text":document.getElementById("type-pass-word").type="passWord"}}}}).call(t,r("L7Pj"))}});