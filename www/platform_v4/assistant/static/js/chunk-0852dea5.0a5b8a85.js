(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0852dea5"],{"0e38":function(t,i,n){"use strict";var s=n("873b"),o=n.n(s);o.a},6122:function(t,i,n){"use strict";var s=n("aedb"),o=n.n(s);o.a},"6a5c":function(t,i,n){},"77e0":function(t,i,n){"use strict";var s=n("e950"),o=n.n(s);o.a},"873b":function(t,i,n){},"941c":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsYAAAAUCAYAAACOAfu4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVCNTM4Q0IzMEU2NjExRTlBOTNBRkQwMjhDRjc2MzhEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVCNTM4Q0I0MEU2NjExRTlBOTNBRkQwMjhDRjc2MzhEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUI1MzhDQjEwRTY2MTFFOUE5M0FGRDAyOENGNzYzOEQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUI1MzhDQjIwRTY2MTFFOUE5M0FGRDAyOENGNzYzOEQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/jZjIAAACQElEQVR42uzdP2tTURwG4BuLKOJaFYdOTqLu4h8QRKSDg10U0cHv4NBN/Ah+AAeRiovSburgX6pzBxcV6qKCU1DEqqW+h0SIpUlvitDe8DzwEsJ5yXCmH+Hce1rtdvtbVVWfknfJo+RBslgBAMDomkimkjPJ4WRPK4PxyqrScnIvuZZ8tGcAAIyQ/cmN5EqyvXdhrcH4ry/J5eSh/QMAYAScTW4n42stDhqMi/Lv8flkzj4CANBg55L7yVi/wnqDcfE9OZos2E8AABroSPIq2TWoVGcwLl4mJ5MV+woAQIO0kmfJifWK22r+4PFk0r4CANAwk3WG4mEG4+LigLXyuovyqrev3c8JXV1dXV1dXV1d3S3QvVB32K17lKJ4nxzos/Y4Od3z/WlySldXV1dXV1dXV3eTu28HzLAbHoyXkp191sq0vrvn+89kh66urq6urq6uru4md38MWPvHMEcpBnm96vu8rq6urq6urq6u7hboLtUdaMemp6ev1+x+SG72WStP+pWr9PYmz5OrSVtXV1dXV1dXV1d3k7vlwrrxOsPuMEcpZpJLFQAANMedujPsMEcpZuwrAAANc7duse4/xuXcRnmXsQs+AABoknLBx4vk2P8YjF0JDQBAk9W6Enq9oxTLVediD0MxAABNtdCdaZc3OhiXJ/umkjl7CQBAw811Z9v2MINxmaTLg3aHkll7CADAiJjtzri3kl+rF8sZ49/5/Jy8SZ5UnSf3Fu0bAAAjbKLqvMatXCV9MNn3R4ABAPKPJUsRDKHYAAAAAElFTkSuQmCC"},ac44:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYwQ0U4NkEzMDM1MjExRTk5NjJDODVCNTc3OTlBQzE3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjYwQ0U4NkE0MDM1MjExRTk5NjJDODVCNTc3OTlBQzE3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NjBDRTg2QTEwMzUyMTFFOTk2MkM4NUI1Nzc5OUFDMTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjBDRTg2QTIwMzUyMTFFOTk2MkM4NUI1Nzc5OUFDMTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5XiFu/AAAA30lEQVR42pzSOwrCQBSF4TEM1j4XIYjvws59BJEYIyLidhQVH6uwUVyHhY3rkImekRMYNC+98GOR+HEzibQXN5EwZXREV+QgFXezTIFdUBV1UBbZcahMwM6ogkaoi8bIR/0oNAosoRM389CeWcQ1OghDw8AisZqB6XlywwxyiX6d6SdYIFbnn3cf1010SNQ1URPME2ugCdpGHIfPzYWBegEagDliTTRFm4S37xubOtxco740sBaaoZVIN4qIxU3fqORH20ZztBS/jeIZWvx9aPCODmgt/hvFx9bH0HsJMADPCjhHXf2pogAAAABJRU5ErkJggg=="},aedb:function(t,i,n){},b1b7:function(t,i,n){"use strict";var s=n("6a5c"),o=n.n(s);o.a},e950:function(t,i,n){},ecae:function(t,i,n){"use strict";n.r(i);var s=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{attrs:{id:"vendor-list"}},[n("base-header",{attrs:{"head-title":"设备列表"}}),n("base-search",{staticClass:"base-search",on:{getScreenBox:t.openSortDialog,"map-click":t.mapiconClickHandle}}),n("div",{staticClass:"vendor-list-content"},t._l(t.vendorList,function(i,s){return n("vendor-card",{key:i.vendor_id,staticClass:"vendor-card",attrs:{"card-info":i,"distance-info":t.vendorDistanceList[s]},on:{"on-replenish":function(n){t.goReplenishHandle(i)},"on-normal":function(n){t.goReplenishHandle(i)}}})}),1),n("van-popup",{staticClass:"change-default-dailog-custom",attrs:{position:"bottom"},on:{"click-overlay":t.sortDialogCancelClick},model:{value:t.showSortDialog,callback:function(i){t.showSortDialog=i},expression:"showSortDialog"}},[n("sort-dialog",{on:{"on-cancel":t.sortDialogCancelClick,"on-confirm":t.sortDialogConfirmClick}})],1)],1)},o=[],e=(n("a2a8"),n("7fc4")),a=(n("3f87"),n("7496"),n("a6eb")),c=n.n(a),r=n("4b4a"),l=n.n(r),d=(n("eee6"),n("de57")),u=(n("ff66"),n("ea23"),n("dbff"),n("1f43")),v=n("3d4d"),h=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"list-card"},[s("div",{staticClass:"card__info_row"},[s("div",{staticClass:"card__row flex-box main-space"},[s("div",{staticClass:"row__item blod-text"},[t._v("\n                 设备编号： "+t._s(t.cardInfo.vendor_id)+"\n            ")]),t.cardInfo.vendor_status===t.VendorStatus.SHORT?s("div",{staticClass:"v-button danger",on:{click:t.shortClickHandle}},[t._v("通知断货")]):t._e(),t.cardInfo.vendor_status==t.VendorStatus.LACK?s("div",{staticClass:"v-button danger",on:{click:t.replenishClickHandle}},[t._v("补货")]):t._e(),t.cardInfo.vendor_status==t.VendorStatus.NORMAL?s("div",{staticClass:"v-button primary",on:{click:t.normalClickHandle}},[t._v("正常")]):t._e()]),s("div",{staticClass:"card__row flex-box main-space vendor-detail-info"},[s("div",{staticClass:"row__item address"},[t._v(" 地址 : "+t._s(t.cardInfo.area)+t._s(t.cardInfo.address))]),s("div",{staticClass:"row__item short"},[t._v(" 缺货数 : "+t._s(t.cardInfo.stock_num)+" ")]),s("div",{staticClass:"row__item out"},[t._v(" 断货数 : "+t._s(t.cardInfo.out_num)+" ")])]),s("div",{staticClass:"card__row flex-box main-space"},[s("div",{staticClass:"row__item text-gray",on:{click:function(i){t.openLocation(t.cardInfo.point)}}},[t._m(0),s("span",{staticClass:"icon-box"},[t._v(t._s(t._f("numFix")(t.cardInfo.distanceStr||0))+" km")]),s("span",{staticClass:"r-border"}),s("span",{staticClass:"icon-box"},[t._v(t._s(t.cardInfo.timeStr))])]),t.cardInfo.stockout_list&&t.cardInfo.stockout_list.length>0?s("div",{staticClass:"row__item",on:{click:t.showDetal}},[s("div",{staticClass:"text-blue flex-box cross-center"},[s("span",[t._v("缺货 / 断货详情 ")]),s("img",{attrs:{src:t.imgIcon}})])]):t._e()]),t.isShowDetail?s("img",{staticClass:"dash-bar",attrs:{src:n("941c")}}):t._e(),t.isShowDetail?s("div",t._l(t.cardInfo.stockout_list,function(i,n){return s("div",{key:n,staticClass:"card__row flex-box main-space"},[s("div",{staticClass:"row__item"},[t._v(t._s(i.aisle_name))]),s("div",{staticClass:"row__item"},[t._v(t._s(i.goods_num))])])}),0):t._e()])])},m=[function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("span",{staticClass:"icon"},[s("img",{attrs:{src:n("de5b"),alt:""}})])}],g=n("a041"),A=n("4a28"),f={props:{cardInfo:{type:Object,default:function(){return{vendor_id:"",vendor_status:1,address:"",stock_num:0,out_num:0,distance:1,time:5,distanceStr:"",timeStr:"",stockout_list:[{goods_name:"",goods_num:12}]}}}},data:function(){return{isShowDetail:!1,imgIcon:n("2917"),VendorStatus:g["e"]}},methods:{showDetal:function(){this.isShowDetail=!this.isShowDetail,this.isShowDetail?this.imgIcon=n("ac44"):this.imgIcon=n("2917")},shortClickHandle:function(){this.$emit("on-short")},replenishClickHandle:function(){this.$emit("on-replenish")},normalClickHandle:function(){this.$emit("on-normal")},openLocation:function(t){A["a"].openLocation(t.lat,t.lng)}}},b=f,p=(n("0e38"),n("25c1")),C=Object(p["a"])(b,h,m,!1,null,"0e3c40be",null);C.options.__file="index.vue";var I=C.exports,_=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"sort-dialog-content"},[n("div",{staticClass:"sort-dialog-title flex-box main-space"},[n("div",{staticClass:"cancel",on:{click:t.sortDialogCancelClick}},[t._v("取消")]),n("div",{staticClass:"label"},[t._v("请选择排列方式")]),n("div",{staticClass:"confirm",on:{click:t.sortDialogConfirmClick}},[t._v("确定")])]),n("div",{staticClass:"van-hairline--bottom"}),n("van-picker",{ref:"vanPickerCate",attrs:{columns:t.sortItemList},on:{change:t.onChange}})],1)},D=[],w={data:function(){return{sortItemList:[{text:"按距离从近到远",value:1}],vendor_status:null,sortValue:1}},created:function(){this.vendor_status=this.$route.query.status,this.init()},methods:{init:function(){var t={text:"按缺货从高到低",value:2},i={text:"按断货从高到低",value:3};this.vendor_status?this.vendor_status===g["e"].LACK?this.sortItemList.push(t):this.vendor_status===g["e"].SHORT&&this.sortItemList.push(i):(this.sortItemList.push(t),this.sortItemList.push(i))},onChange:function(t,i){this.sortValue=i.value},sortDialogCancelClick:function(){this.$emit("on-cancel")},sortDialogConfirmClick:function(){this.$emit("on-confirm",this.sortValue)}}},S=w,k=(n("b1b7"),Object(p["a"])(S,_,D,!1,null,"192b88b8",null));k.options.__file="SortDialog.vue";var M=k.exports,L=n("4ec3"),N=n("96d3"),R=n("9975"),E=n("f2de"),V={components:{BaseHeader:u["a"],BaseSearch:v["a"],VendorCard:I,SortDialog:M},data:function(){return{vendorList:[],vendorPointList:[],promiseList:[],vendorDistanceList:[],vendor_status:null,locationPoint:{lat:22.55329,lng:113.88308},showSortDialog:!1,sortValue:1}},computed:Object(d["a"])({},Object(E["c"])({wxSdkConfig:function(t){return t.wxSdkConfig}})),watch:{wxSdkConfig:function(t){t&&this.calcuDistance()}},created:function(){this.vendor_status=this.$route.query.status},mounted:function(){this.getVendorList()},methods:Object(d["a"])({},Object(E["b"])(["SET_MAPPOINTLIST"]),{getVendorList:function(){var t=this,i={page_no:1,page_size:99,get_vendor_list:1,shop_id:R["a"].getShopid()};this.vendor_status?i.vendor_status_list=[this.vendor_status]:i.vendor_status_list=[1,3,4],this.sortValue&&(i.sort=this.sortValue),console.log("设备列表 req=>",i),Object(L["j"])(i).then(function(i){console.log("设备列表 res=>",i),0===i.ret?(t.vendorList=i.data.vendor_list,t.vendorList.map(function(i){var n="".concat(i.province).concat(i.city).concat(i.area).concat(i.address);return t.promiseList.push(N["a"].getPoint(n)),N["a"].getPoint(n).then(function(n){t.vendorPointList.push(n),i.point=n}),i}),t.wxSdkConfig&&t.calcuDistance()):t.$toast({message:g["f"].toString(i.ret),duration:2e3})})},goReplenishHandle:function(t){this.$router.push({path:"/replenish/handle",query:{vendorid:t.vendor_id}})},getLocation:function(){var t=this;return new l.a(function(i){A["a"].getLocation().then(function(n){t.locationPoint=n,i(n)})})},getDistance:function(){var t=this,i="".concat(this.locationPoint.lat,",").concat(this.locationPoint.lng),n=this.vendorPointList.map(function(t){return"".concat(t.lat,",").concat(t.lng)}),s=n.join(";");N["a"].getDistance(i,s).then(function(i){t.vendorDistanceList=i.elements,t.vendorList.map(function(i,n){i.distance=t.vendorDistanceList[n].distance,i.duration=t.vendorDistanceList[n].duration,t.$set(i,"distanceStr",i.distance/1e3),t.$set(i,"timeStr",t.getDateDiff(i.duration))})})},getDateDiff:function(t){var i,n=60,s=60*n,o=t/s,e=t/n;if(o>=1){var a=c()(e-60*c()(o));i=c()(o)+"小时",a>=1&&(i=i+a+"分钟")}else i=e>=1?c()(e)+"分钟":"1分钟";return i},calcuDistance:function(){var t=this,i=this.getLocation();l.a.all([].concat(Object(e["a"])(this.promiseList),[i])).then(function(i){t.getDistance()})},openSortDialog:function(){this.showSortDialog=!0},sortDialogCancelClick:function(){this.showSortDialog=!1},sortDialogConfirmClick:function(t){this.sortValue=t,1===this.sortValue?this.vendorList.sort(this.distanceSortFuc):(this.getVendorList(),this.calcuDistance()),this.showSortDialog=!1},distanceSortFuc:function(t,i){return t.distance-i.distance},mapiconClickHandle:function(){var t=this.vendorList.map(function(t){var i="".concat(t.province).concat(t.city).concat(t.area).concat(t.address),n={};return n.text=i,n.lat=(t.point||{}).lat,n.lng=(t.point||{}).lng,n});this.SET_MAPPOINTLIST({mapPointList:t}),this.$router.push("/map")}})},O=V,j=(n("77e0"),n("6122"),Object(p["a"])(O,s,o,!1,null,"298d7d19",null));j.options.__file="index.vue";i["default"]=j.exports}}]);