webpackJsonp([65],{Lich:function(e,t){},dDe3:function(e,t){},r16B:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("EU70"),r=n("GAg9"),o=n("P9l9"),i=n("N6PA"),s=n("6nXL"),l={components:{citySelect:n("9aGi").a,PreviewImg:a.a,ImgUpload:r.a},data:function(){var e=this;return{isOfficial:1,isTextBtn:0,BtnText:"",isCheckAllInput:!1,agentForm:{agent_type:"",agent_type_txt:"",agent_logo:"",address:"",agent_level:"",agent_level_txt:"",employee_name:"",from:""},rules:{agent_type:[{required:!0,message:"请选择代理商类型",trigger:"change"}],agent_level:[{required:!0,message:"请选择代理商级别",trigger:"change"}],agent_name:[{required:!0,validator:function(t,n,a){e.agentForm.agent_name&&""!==e.agentForm.agent_name?!1===/^[^ ]+$/.test(e.agentForm.agent_name)?a(new Error("代理商名称不能包含空格符")):a():a(new Error("请输入代理商名称"))},trigger:"change"}],real_name:[{required:!0,validator:function(t,n,a){e.agentForm.real_name&&""!==e.agentForm.real_name?!1===/^[^ ]+$/.test(e.agentForm.real_name)?a(new Error("联系人不能包含空格符")):a():a(new Error("请输入联系人"))},trigger:"change,blur"}],address:[{required:!0,validator:function(e,t,n){t&&""!==t?!1===/^[^ ]+$/.test(t)?n(new Error("地址不能包含空格符")):n():n(new Error("请输入地址"))},trigger:"change"}],from:[{required:!0,message:"请选择代理商来源",trigger:"change,blur"}],employee_name:[{required:!0,message:"请选择销售人员",trigger:"change,blur"}],phone:[{required:!0,validator:function(t,n,a){var r=i.b.isTelePhone(e.agentForm.phone);return e.agentForm.phone&&""!==e.agentForm.phone?r?void a():a(new Error("请输入合法的电话号码")):a(new Error("请输入电话号码"))},trigger:"change,blur"}],agent_area:[{required:!0,validator:function(t,n,a){e.cityinfo.province&&e.cityinfo.city?a():a(new Error("请选择代理区域"))},trigger:"change,blur"}],telephone:[{required:!0,validator:function(t,n,a){var r=i.b.isLandLinePhone(e.agentForm.telephone);return e.agentForm.telephone&&""!==e.agentForm.telephone?r?void a():a(new Error("请输入合法的电话号码")):a(new Error("请输入电话号码"))},trigger:"change,blur"}],email:[{required:!0,validator:function(t,n,a){var r=i.b.isEmail(e.agentForm.email);e.agentForm.email&&""!==e.agentForm.email?r?a():a(new Error("请输入正确的邮箱格式")):a(new Error("请输入邮箱地址"))},trigger:"input"}],password:[{required:!0,validator:function(t,n,a){var r=i.b.isPassWord(n);e.agentForm.password?(r||a(new Error("密码格式必须是字母、数字，不能使用特殊字符，长度在6-16之间")),a()):a(new Error("请输入密码"))},trigger:"change,blur"}],re_password:[{required:!0,validator:function(t,n,a){e.agentForm.re_password?e.agentForm.re_password!==e.agentForm.password?a(new Error("两次输入密码不一致!")):a():a(new Error("请再次输入密码"))},trigger:"change,blur"}]},isSelectError:!1,isClickNextStep:!1,employeeOptions:[],fromOptions:[],agentTypeOptions:[{label:s.z.toString(s.z.REGION),value:s.z.REGION},{label:s.z.toString(s.z.INDUSTRY),value:s.z.INDUSTRY}],AgentLevelOption:[{label:s.c.toString(s.c.FIRST),value:s.c.FIRST},{label:s.c.toString(s.c.SECOND),value:s.c.SECOND},{label:s.c.toString(s.c.THREE),value:s.c.THREE}],cityinfo:{province:"",city:"",area:""}}},props:{agentId:{type:String,default:""}},computed:{MerchantAgentType:function(){return s.z},isCantInput:function(){return!!this.agentId}},created:function(){this.getEmployeeOption(),this.getFromList(),this.agentId&&this.getAgentInfo()},methods:{getFromList:function(){var e=this;Object(o.G)({get_from_list:1,only_from:1}).then(function(t){0===t.ret?e.fromOptions=t.data.list:e.$slnotify({message:s.X.toString(t.ret)})})},getAgentInfo:function(){var e=this,t={agent_info:1,agent_id:this.agentId};Object(o.n)(t).then(function(t){if(0===t.ret){var n=t.data.agent_info;e.agentForm.agent_type=n.agent_type,e.agentForm.agent_type_txt=s.z.toString(n.agent_type),e.agentForm.agent_name=n.agent_name,e.agentForm.phone=n.phone,e.agentForm.password=n.password,e.agentForm.re_password=n.password,e.agentForm.from=n.from,e.agentForm.employee_name=n.real_name,e.agentForm.real_name=n.relation_name,e.agentForm.telephone=n.telephone,e.agentForm.agent_level=n.agent_level,e.agentForm.agent_level_txt=s.c.toString(n.agent_level),e.agentForm.email=n.email,e.agentForm.address=n.address,e.agentForm.re_password=e.agentForm.password,e.cityinfo.province=n.agent_province,e.cityinfo.city=n.agent_city,e.cityinfo.area=n.agent_area,""!==n.agent_logo&&null!==n.agent_logo&&(e.agentForm.agent_logo=n.agent_logo,e.isImg=!0,e.isOfficial=0,e.isTextBtn=1,e.BtnText="重新上传")}else e.$slnotify({message:s.X.toString(t.ret)})})},getEmployeeOption:function(){var e=this;Object(o._1)({get_pl_salesman_list:1}).then(function(t){0===t.ret?e.employeeOptions=t.data.list:e.$slnotify({message:s.X.toString(t.ret)})})},getPhoto:function(e){this.agentForm.agent_logo=e,""!==this.agentForm.agent_logo&&null!==this.agentForm.agent_logo&&(this.isImg=!0,this.isOfficial=0,this.isTextBtn=1,this.BtnText="重新上传")},changeProvinces:function(e){this.cityinfo.province=e.province,this.cityinfo.city=e.city,this.cityinfo.area=e.blocks,""===this.cityinfo.province||""===this.cityinfo.city?this.isSelectError=!0:(this.isSelectError=!1,this.checkFinishInput("agentForm"))},goNextStep:function(e){var t=this;this.isClickNextStep=!0,this.$refs[e].validate(function(e){if(!e)return!1;t.$refs.agentFormr.validate(function(e){if(!e)return!1;t.saveInfo(0)})})},saveAndReset:function(e){var t=this;this.isClickNextStep=!0,this.$refs[e].validate(function(e){if(!e)return!1;t.$refs.agentFormr.validate(function(e){if(!e)return!1;t.saveInfo(1)})})},checkFinishInput:function(e){""!==this.agentForm.type&&""!==this.agentForm.agent_level&&""!==this.agentForm.employee_name&&this.agentForm.phone&&this.agentForm.password&&this.agentForm.re_password&&this.agentForm.real_name&&this.agentForm.telephone&&this.agentForm.address?(this.$refs[e].validate(function(e){return!!e}),this.isClickNextStep=!1):this.isClickNextStep&&this.$refs[e].validate(function(e){return!!e})},saveInfo:function(e){var t=this,n={agent_save:1,agent_name:this.agentForm.agent_name,telephone:this.agentForm.telephone,phone:this.agentForm.phone,real_name:this.agentForm.real_name,email:this.agentForm.email,address:this.agentForm.address,password:this.agentForm.password,re_password:this.agentForm.re_password,agent_type:this.agentForm.agent_type,agent_level:this.agentForm.agent_level,from:this.agentForm.from,agent_logo:this.agentForm.agent_logo,agent_province:this.cityinfo.province,agent_city:this.cityinfo.city,agent_area:this.cityinfo.area,employee_name:this.agentForm.employee_name,bs_agent_save:1};this.agentId&&(n.agent_id=this.agentId),Object(o.o)(n).then(function(n){0===n.ret?(0===e?(t.$emit("showIcbc",n.data.agent_id),t.$slnotify({message:"保存成功"})):(t.$refs.agentFormr.resetFields(),t.$refs.agentForm.resetFields(),t.agentId="",t.agentForm.agent_level_txt="",t.agentForm.agent_type_txt="",t.cityinfo.province="",t.cityinfo.city="",t.cityinfo.area="",t.isImg=!0,t.isOfficial=1,t.isTextBtn=0,t.BtnText="提交",t.$slnotify({message:"保存成功"})),t.isClickNextStep=!1):(t.isClickNextStep=!0,t.$slnotify({message:s.X.toString(n.ret)}))})}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"creat-agent-official"},[n("div",{staticClass:"official-title-bar"},[e._v("创建代理商")]),e._v(" "),n("div",{staticClass:"creat-form clearfix"},[n("div",{staticClass:"clearfix"},[n("el-form",{ref:"agentForm",staticClass:"fl form-left",attrs:{model:e.agentForm,rules:e.rules,"label-width":"110px"}},[n("el-form-item",{attrs:{label:"代理商类型",prop:"agent_type"}},[e.isCantInput?n("span",[e._v(e._s(e.agentForm.agent_type_txt))]):n("el-select",{attrs:{placeholder:"请选择代理商类型"},on:{change:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.agent_type,callback:function(t){e.$set(e.agentForm,"agent_type",t)},expression:"agentForm.agent_type"}},e._l(e.agentTypeOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"代理商级别",prop:"agent_level"}},[e.isCantInput?n("span",[e._v(e._s(e.agentForm.agent_level_txt))]):n("el-select",{attrs:{placeholder:"请选择代理商级别"},on:{change:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.agent_level,callback:function(t){e.$set(e.agentForm,"agent_level",t)},expression:"agentForm.agent_level"}},e._l(e.AgentLevelOption,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),e.agentForm.agent_type!==e.MerchantAgentType.INDUSTRY?n("el-form-item",{attrs:{label:"代理区域",prop:"agent_area"}},[e.isCantInput?n("span",[e._v(e._s(e.cityinfo.province+e.cityinfo.city+e.cityinfo.area))]):n("city-select",{staticClass:"city-select",attrs:{isSelectError:e.isSelectError,cityinfo:e.cityinfo},on:{changeProvinces:e.changeProvinces}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"代理商名称",prop:"agent_name"}},[n("el-input",{attrs:{placeholder:"请输入代理商名称"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.agent_name,callback:function(t){e.$set(e.agentForm,"agent_name",t)},expression:"agentForm.agent_name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"登录账号",prop:"phone"}},[e.isCantInput?n("span",[e._v(e._s(e.agentForm.phone))]):n("el-input",{attrs:{placeholder:"请输入登录账号"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.phone,callback:function(t){e.$set(e.agentForm,"phone",t)},expression:"agentForm.phone"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"登录密码",prop:"password"}},[e.isCantInput?n("span",[e._v("******")]):n("el-input",{attrs:{type:"password",placeholder:"请输入登录密码"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.password,callback:function(t){e.$set(e.agentForm,"password",t)},expression:"agentForm.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"确认登录密码",prop:"re_password"}},[e.isCantInput?n("span",[e._v("******")]):n("el-input",{attrs:{type:"password",placeholder:"请确认登录密码"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.re_password,callback:function(t){e.$set(e.agentForm,"re_password",t)},expression:"agentForm.re_password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"联系人",prop:"real_name"}},[n("el-input",{attrs:{placeholder:"请输入联系人"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.real_name,callback:function(t){e.$set(e.agentForm,"real_name",t)},expression:"agentForm.real_name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[n("el-input",{attrs:{placeholder:"请输入联系电话"},on:{input:function(t){e.checkFinishInput("agentForm")}},model:{value:e.agentForm.telephone,callback:function(t){e.$set(e.agentForm,"telephone",t)},expression:"agentForm.telephone"}})],1)],1),e._v(" "),n("el-form",{ref:"agentFormr",staticClass:"fl form-right",attrs:{model:e.agentForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[e.isCantInput?n("span",[e._v(e._s(e.agentForm.email))]):n("el-input",{attrs:{placeholder:"请输入邮箱"},on:{input:function(t){e.checkFinishInput("agentFormr")}},model:{value:e.agentForm.email,callback:function(t){e.$set(e.agentForm,"email",t)},expression:"agentForm.email"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"地址",prop:"address"}},[n("el-input",{attrs:{placeholder:"请输入地址"},on:{input:function(t){e.checkFinishInput("agentFormr")}},model:{value:e.agentForm.address,callback:function(t){e.$set(e.agentForm,"address",t)},expression:"agentForm.address"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"代理商来源",prop:"from"}},[n("el-select",{attrs:{placeholder:"请选择代理商来源"},on:{change:function(t){e.checkFinishInput("agentFormr")}},model:{value:e.agentForm.from,callback:function(t){e.$set(e.agentForm,"from",t)},expression:"agentForm.from"}},e._l(e.fromOptions,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"销售人员",prop:"employee_name"}},[n("el-select",{attrs:{placeholder:"请选择销售人员"},on:{change:function(t){e.checkFinishInput("agentFormr")}},model:{value:e.agentForm.employee_name,callback:function(t){e.$set(e.agentForm,"employee_name",t)},expression:"agentForm.employee_name"}},e._l(e.employeeOptions,function(e){return n("el-option",{key:e.pl_name,attrs:{label:e.pl_name,value:e.pl_name}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"logo",prop:"agent_logo"}},[n("div",{staticClass:"certi-upload"},[n("Preview-Img",{staticClass:"fl certi-upload_right",attrs:{width:"309px",height:"217px",imgSrc:e.agentForm.agent_logo}}),e._v(" "),n("img-upload",{staticClass:"certi-upload-btn",class:{"upload-agin":e.BtnText.length>3},attrs:{FreedomCrop:!1,isOfficial:e.isOfficial,isTextBtn:e.isTextBtn,BtnText:e.BtnText},on:{"send-image":e.getPhoto}}),e._v(" "),e.agentForm.agent_logo?e._e():n("div",{staticClass:"upload-img-text"},[n("span",{staticClass:"unload-title"},[e._v("添加图片")]),e._v(" "),n("div",{staticClass:"upload-text"},[e._v("支持JPG、JPEG、PNG文件格式")])])],1)]),e._v(" "),n("el-form-item",[n("div",{staticClass:"warm-tips"},[e._v("温馨提示 : 带\n          "),n("span",{staticClass:"icon-red"},[e._v("*")]),e._v("号选项为必填项 ")])])],1)],1),e._v(" "),n("div",{staticClass:"footer "},[n("div",{staticClass:"of-btn-bd-b-blue can-click-btn",on:{click:function(t){e.goNextStep("agentForm")}}},[e._v("下一步")]),e._v(" "),n("div",{staticClass:"save-m-gradient",on:{click:function(t){e.saveAndReset("agentForm")}}},[e._v("保存并提交")])])])])},staticRenderFns:[]};var c=n("C7Lr")(l,g,!1,function(e){n("dDe3"),n("Lich")},"data-v-fbfe83c0",null);t.default=c.exports}});