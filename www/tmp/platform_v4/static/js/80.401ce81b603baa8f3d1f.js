webpackJsonp([80],{ANHr:function(o,t){},"n+du":function(o,t){},yCZz:function(o,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r("6nXL"),i=r("9aGi"),s=r("EU70"),n=r("GAg9"),a=r("N6PA"),c=r("P9l9"),l=r("a2vD"),f={data:function(){var o=this;return{isOfficial:1,isTextBtn:0,BtnText:"",agentId:l.a.getPlAgentid(),isSelectError:!1,isCheckAllInput:!1,salesMen:l.a.getSalesMen(),basicInfroForm:{},basicInfroFormc:{},employeeOptions:[],basicInfroFormr:{shop_logo:""},tagSelect:["中餐"],rules:{from:[{required:!0,message:"请选择商户来源",trigger:"change,click"}],address:[{required:!0,validator:function(o,t,r){var e=a.b.isSpacebar(t);t&&""!==t?e?r():r(new Error("地址不能包含空格符")):r(new Error("请输入地址"))},trigger:"change,click"}],shop_name:[{required:!0,validator:function(o,t,r){var e=a.b.isSpacebar(t);t&&""!==t?e?r():r(new Error("店铺名称不能包含空格符")):r(new Error("请输入店铺名称"))},trigger:"change,click"}],employee_name:[{required:!0,message:"请选择销售人员",trigger:"change,click"}],real_name:[{required:!0,validator:function(o,t,r){var e=a.b.isSpacebar(t);t&&""!==t?e?r():r(new Error("商户联系人不能包含空格符")):r(new Error("请输入商户联系人"))},trigger:"change,input,click"}],telephone:[{required:!0,validator:function(o,t,r){var e=a.b.isLandLinePhone(t);return t?e?void r():r(new Error("请输入合法的电话号码")):r(new Error("请输入电话号码"))},trigger:"change,input,click"}],phone:[{required:!0,validator:function(o,t,r){var e=a.b.isTelePhone(t);return t?e?void r():r(new Error("请输入合法的电话号码")):r(new Error("请输入电话号码"))},trigger:"change,input,click"}],password:[{required:!0,validator:function(t,r,e){var i=a.b.isPassWord(r);o.basicInfroForm.password?(i||e(new Error("密码格式必须是字母、数字，不能使用特殊字符，长度在6-16之间")),e()):e(new Error("请输入密码"))},trigger:"change,input,click"}],re_password:[{required:!0,validator:function(t,r,e){o.basicInfroForm.re_password?r!==o.basicInfroForm.password?e(new Error("两次输入密码不一致!")):e():e(new Error("请再次输入密码"))},trigger:"change,input,click"}],email:[{required:!0,validator:function(o,t,r){var e=a.b.isEmail(t);""===t?r(new Error("请输入邮箱地址")):e?r():r(new Error("请输入正确的邮箱格式"))},trigger:"change,input,click"}],shop_area:[{required:!0,validator:function(o,t,r){var e=a.b.isShopArea(t);return t?isNaN(t)?r(new Error("请输入有效的店铺面积")):e?void r():r(new Error("请输入有效的店铺面积(最多保留两位小数)")):r(new Error("请输入店铺面积"))},trigger:"change,input,click"}]},cityinfo:{province:"",city:"",area:""},fromOptions:[],shopTag:[{text:e.B.toString(e.B.CHINESE),idx:e.B.CHINESE},{text:e.B.toString(e.B.WESTERN),idx:e.B.WESTERN},{text:e.B.toString(e.B.SOUTHEASTASIA),idx:e.B.SOUTHEASTASIA},{text:e.B.toString(e.B.FAST),idx:e.B.FAST},{text:e.B.toString(e.B.VEGETALE),idx:e.B.VEGETALE},{text:e.B.toString(e.B.CASUAL),idx:e.B.CASUAL},{text:e.B.toString(e.B.DINNER),idx:e.B.DINNER},{text:e.B.toString(e.B.GROUP),idx:e.B.GROUP},{text:e.B.toString(e.B.HOTPOT),idx:e.B.HOTPOT},{text:e.B.toString(e.B.TEADRINK),idx:e.B.TEADRINK},{text:e.B.toString(e.B.INTERNATIONAL),idx:e.B.INTERNATIONAL}]}},components:{citySelect:i.a,PreviewImg:s.a,ImgUpload:n.a},created:function(){this.getEmployeeOption(),this.getFromList(),this.shopId&&this.getLastStep()},computed:{isCantInput:function(){return!!this.basicInfroForm.shop_id}},props:{shopId:{type:String,default:""}},mounted:function(){this.shopId&&this.getLastStep()},methods:{getFromList:function(){var o=this;Object(c.G)({get_from_list:1,only_from:1}).then(function(t){0===t.ret?o.fromOptions=t.data.list:o.$slnotify({message:e.X.toString(t.ret)})})},getLastStep:function(){var o=this,t={get_shop_info:1,shop_id:this.shopId,shop_bs_info:1,platform:1};Object(c._6)(t).then(function(t){0===t.ret?(o.basicInfroForm=t.data.shopinfo,o.basicInfroForm.from_txt=t.data.shopinfo.from,o.basicInfroForm.from=t.data.shopinfo.from,o.basicInfroForm.re_password=t.data.shopinfo.password,o.basicInfroFormr=t.data.shopinfo,o.tagSelect=t.data.shopinfo.shop_model,""!==o.basicInfroFormr.shop_logo&&null!==o.basicInfroFormr.shop_logo&&(o.isImg=!0,o.isOfficial=0,o.isTextBtn=1,o.BtnText="重新上传"),o.cityinfo.province=t.data.shopinfo.province,o.cityinfo.city=t.data.shopinfo.city,o.cityinfo.area=t.data.shopinfo.area):o.$slnotify({message:e.X.toString(t.ret)})})},getEmployeeOption:function(){var o=this,t={get_ag_salesman_list:1,agent_id:l.a.getPlAgentid(),audit_person:[1,2]};Object(c.c)(t).then(function(t){0===t.ret?o.employeeOptions=t.data.list:o.$slnotify({message:e.X.toString(t.ret)})})},getPhoto:function(o){this.basicInfroFormr.shop_logo=o,""!==this.basicInfroFormr.shop_logo&&null!==this.basicInfroFormr.shop_logo&&(this.isImg=!0,this.isOfficial=0,this.isTextBtn=1,this.BtnText="重新上传")},changeProvinces:function(o){this.cityinfo.province=o.province,this.cityinfo.city=o.city,this.cityinfo.area=o.blocks,""!==this.cityinfo.province&&""!==this.cityinfo.city&&this.basicInfroFormr.address?(this.isSelectError=!1,this.checkFinishInput("basicInfoForm")):this.isSelectError=!0},goNextStep:function(o){var t=this;this.isCheckAllInput=!0,""===this.cityinfo.province||""===this.cityinfo.city||""===this.basicInfroFormr.address?this.isSelectError=!0:this.isSelectError=!1,this.isSelectError||this.$refs[o].validate(function(o){if(!o)return""===t.cityinfo.province||""===t.cityinfo.city||""===t.basicInfroFormr.address?t.isSelectError=!0:t.isSelectError=!1,!1;t.isSelectError=!1,t.saveInfo(1)})},saveAndReset:function(o){var t=this;this.isCheckAllInput=!0,""!==this.cityinfo.province&&""!==this.cityinfo.city&&this.basicInfroFormr.address?(this.isSelectError=!1,this.checkFinishInput("basicInfoForm")):this.isSelectError=!0,this.isSelectError||this.$refs[o].validate(function(o){if(!o)return!1;t.saveInfo(0)})},inputFloor:function(){""!==this.cityinfo.province&&""!==this.cityinfo.city&&this.basicInfroFormr.address?(this.isSelectError=!1,this.checkFinishInput("basicInfoForm")):this.isSelectError=!0},checkFinishInput:function(){""!==this.basicInfroForm.from&&this.basicInfroForm.shop_name&&this.basicInfroForm.real_name&&this.basicInfroForm.phone&&this.basicInfroForm.password&&this.basicInfroForm.re_password&&this.basicInfroForm.email&&this.basicInfroForm.shop_area&&this.basicInfroFormr.address?this.$refs.basicInfoForm.validate(function(o){return!!o}):this.isCheckAllInput&&this.$refs.basicInfoForm.validate(function(o){return!!o})},vaodateInput:function(o){var t=this;this.$refs[o].validate(function(o){if(!o)return t.isCheckAllInput=!1,!1;t.isCheckAllInput&&t.saveInfo(1)})},saveInfo:function(o){var t=this,r={shop_save:1,platform:1,agent_id:this.agentId,shop_name:this.basicInfroForm.shop_name,shop_logo:this.basicInfroFormr.shop_logo,shop_area:this.basicInfroForm.shop_area,address:this.basicInfroFormr.address,shop_model:this.tagSelect,telephone:this.basicInfroForm.telephone,province:this.cityinfo.province,city:this.cityinfo.city,area:this.cityinfo.area,from:this.basicInfroForm.from,employee_name:this.basicInfroForm.employee_name,phone:this.basicInfroForm.phone,real_name:this.basicInfroForm.real_name,email:this.basicInfroForm.email,password:this.basicInfroForm.password,re_password:this.basicInfroForm.re_password,shop_bs_save:1};this.shopId&&(r.shop_id=this.shopId),Object(c._7)(r).then(function(r){0===r.ret?(t.isCheckAllInput=!1,1===o?(t.shop_id=r.data.shop_id,t.$emit("goIcbcInfo",t.shop_id)):(scrollTo(0,0),t.basicInfroForm.shop_id="",t.cityinfo.province="",t.cityinfo.city="",t.cityinfo.area="",t.tagSelect=["中餐"],t.basicInfroFormr.shop_logo="",t.$refs.basicInfoForm.resetFields(),t.$refs.basicInfoFormr.resetFields(),t.isImg=!0,t.isOfficial=1,t.isTextBtn=0,t.BtnText="提交")):(t.isCheckAllInput=!0,t.$slnotify({message:e.X.toString(r.ret)}))})}}},p={render:function(){var o=this,t=o.$createElement,r=o._self._c||t;return r("div",{staticClass:"base-merchant-official"},[r("div",{staticClass:"official-title-bar"},[o._v("新增商户")]),o._v(" "),r("div",{staticClass:"clearfix"},[r("div",{staticClass:"form-item float-left"},[r("el-form",{ref:"basicInfoForm",staticClass:"demo-ruleForm float-left",attrs:{"label-width":"100px",model:o.basicInfroForm,rules:o.rules}},[r("el-form-item",{attrs:{label:"销售人员",prop:"employee_name"}},[o.isCantInput?r("span",[o._v(o._s(o.basicInfroForm.employee_name))]):r("el-select",{attrs:{placeholder:"请选择销售人员"},on:{change:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.employee_name,callback:function(t){o.$set(o.basicInfroForm,"employee_name",t)},expression:"basicInfroForm.employee_name"}},o._l(o.employeeOptions,function(o){return r("el-option",{key:o.ag_employee_name,attrs:{label:o.ag_employee_name,value:o.ag_employee_name}})}),1)],1),o._v(" "),r("el-form-item",{attrs:{label:"商户来源",prop:"from"}},[o.isCantInput?r("span",[o._v(o._s(o.basicInfroForm.from_txt))]):r("el-select",{attrs:{placeholder:"请选择商户来源"},on:{change:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.from,callback:function(t){o.$set(o.basicInfroForm,"from",t)},expression:"basicInfroForm.from"}},o._l(o.fromOptions,function(o){return r("el-option",{key:o,attrs:{label:o,value:o}})}),1)],1),o._v(" "),r("el-form-item",{attrs:{label:"商户名称",prop:"shop_name"}},[r("el-input",{attrs:{placeholder:"商户名称"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.shop_name,callback:function(t){o.$set(o.basicInfroForm,"shop_name",t)},expression:"basicInfroForm.shop_name"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"商户联系人",prop:"real_name"}},[o.isCantInput?r("span",[o._v(o._s(o.basicInfroForm.real_name))]):r("el-input",{attrs:{placeholder:"姓名"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.real_name,callback:function(t){o.$set(o.basicInfroForm,"real_name",t)},expression:"basicInfroForm.real_name"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[r("el-input",{attrs:{placeholder:"固定电话"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.telephone,callback:function(t){o.$set(o.basicInfroForm,"telephone",t)},expression:"basicInfroForm.telephone"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[o.isCantInput?r("span",[o._v(o._s(o.basicInfroForm.phone))]):r("el-input",{attrs:{placeholder:"手机号码(默认登录账号)"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.phone,callback:function(t){o.$set(o.basicInfroForm,"phone",t)},expression:"basicInfroForm.phone"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"账户密码",prop:"password"}},[o.isCantInput?r("span",[o._v("******")]):r("el-input",{attrs:{type:"password",placeholder:"设置6-16位密码"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.password,callback:function(t){o.$set(o.basicInfroForm,"password",t)},expression:"basicInfroForm.password"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"确认密码",prop:"re_password"}},[o.isCantInput?r("span",[o._v("******")]):r("el-input",{attrs:{type:"password",placeholder:"设置6-16位密码"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.re_password,callback:function(t){o.$set(o.basicInfroForm,"re_password",t)},expression:"basicInfroForm.re_password"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o.isCantInput?r("span",[o._v(o._s(o.basicInfroForm.email))]):r("el-input",{attrs:{placeholder:"电子邮箱"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.email,callback:function(t){o.$set(o.basicInfroForm,"email",t)},expression:"basicInfroForm.email"}})],1),o._v(" "),r("el-form-item",{attrs:{label:"商户面积",prop:"shop_area"}},[r("el-input",{attrs:{placeholder:"面积"},on:{input:function(t){o.checkFinishInput("basicInfoForm")}},model:{value:o.basicInfroForm.shop_area,callback:function(t){o.$set(o.basicInfroForm,"shop_area",t)},expression:"basicInfroForm.shop_area"}})],1)],1)],1),o._v(" "),r("div",{staticClass:"form-itemrr float-left"},[r("el-form",{ref:"basicInfoFormr",staticClass:"demo-ruleForm float-left",attrs:{"label-width":"100px",model:o.basicInfroFormr,rules:o.rules}},[r("el-form-item",{staticClass:"address-item",class:{"is-error":o.isSelectError},attrs:{label:"商户地址",prop:"address"}},[r("city-select",{staticClass:"city-select",attrs:{isSelectError:o.isSelectError,cityinfo:o.cityinfo},on:{changeProvinces:o.changeProvinces}}),o._v(" "),r("div",[r("el-input",{staticClass:"input-floo",attrs:{placeholder:"街道楼盘名称房号"},on:{input:o.inputFloor},model:{value:o.basicInfroFormr.address,callback:function(t){o.$set(o.basicInfroFormr,"address",t)},expression:"basicInfroFormr.address"}})],1),o._v(" "),o.isSelectError?r("p",[o._v("请填写商户地址(地址不能包含空格)")]):o._e()],1),o._v(" "),r("el-form-item",{staticClass:"select-must",attrs:{label:"商户业态"}},[r("el-checkbox-group",{attrs:{min:1},model:{value:o.tagSelect,callback:function(t){o.tagSelect=t},expression:"tagSelect"}},o._l(o.shopTag,function(t){return r("el-checkbox-button",{key:t.text,attrs:{label:t.text}},[o._v("\n              "+o._s(t.text)+"\n            ")])}),1)],1),o._v(" "),r("el-form-item",{staticClass:"logo-item",attrs:{label:"商户logo",prop:"shop_logo"}},[r("div",{staticClass:"certi-upload"},[r("Preview-Img",{staticClass:"fl certi-upload_right",attrs:{width:"309px",height:"217px",imgSrc:o.basicInfroFormr.shop_logo}}),o._v(" "),r("img-upload",{staticClass:"certi-upload-btn",class:{"upload-agin":o.BtnText.length>3},attrs:{FreedomCrop:!1,isOfficial:o.isOfficial,isTextBtn:o.isTextBtn,BtnText:o.BtnText},on:{"send-image":o.getPhoto}}),o._v(" "),o.basicInfroFormr.shop_logo?o._e():r("div",{staticClass:"upload-img-text"},[r("span",{staticClass:"unload-title"},[o._v("添加图片")]),o._v(" "),r("div",{staticClass:"upload-text"},[o._v("支持JPG、JPEG、PNG文件格式")])])],1)])],1)],1)]),o._v(" "),r("div",{staticClass:"footer"},[r("div",{staticClass:"of-btn-bd-b-blue cant-click-btn",on:{click:function(t){o.goNextStep("basicInfoForm")}}},[o._v("下一步")]),o._v(" "),r("div",{staticClass:"save-m-gradient",on:{click:function(t){o.saveAndReset("basicInfoForm")}}},[o._v("保存并提交")])])])},staticRenderFns:[]};var m=r("C7Lr")(f,p,!1,function(o){r("ANHr"),r("n+du")},"data-v-545be620",null);t.default=m.exports}});