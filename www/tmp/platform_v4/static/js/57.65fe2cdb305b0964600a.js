webpackJsonp([57],{"0ZrM":function(t,e){},C9pl:function(t,e,i){"use strict";(function(t){var s=i("4YfN"),a=i.n(s),l=i("r2UX"),n=i("//xf"),o=i("P9l9"),r=i("6nXL"),c=i("EuEE"),p=i("9rMa");e.a={components:{SelectCate:n.default,EmptyTable:l.a},data:function(){return{goods_name:"",min_price:"",max_price:"",category_id:"",resetCate:!0,list:[],emptyType:1,multipleSelection:[],total:100,listQuery:{page:1,limit:10},isSort:!1,sortLabel:"",sortOrder:1,singleDelete:!1,muDelete:!1,goodArrOpr:[],dialogDelId:""}},created:function(){this.getList()},computed:{isListEmpty:function(){return 0===this.list.length}},mounted:function(){var e=this.$refs.manageGoodsListTableAdjust.$refs.bodyWrapper;this.$nextTick(function(){c.a.AdjustMinHeight(e)}),t(window).resize(function(){c.a.AdjustMinHeight(e)})},methods:a()({},Object(p.c)(["SMG_SET_GOODCATEID","SET_SELECTMENU"]),{getList:function(){var t=this,e={get_goods_list:1,is_draft:1,page_size:this.listQuery.limit,page_no:this.listQuery.page};this.goods_name&&(e.goods_name=this.goods_name),this.category_id&&(e.category_id=this.category_id),this.min_price&&(e.min_price=this.min_price),this.max_price&&(e.max_price=this.max_price),this.min_price&&this.max_price&&Number(this.min_price)>Number(this.max_price)?this.$notify({title:"警告",message:"最高价格不能小于最低价",type:"warning"}):(this.isSort&&(e.sortby=this.sortLabel,e.sort=this.sortOrder),Object(o.M)(e).then(function(e){0===e.ret?(t.list=e.data.goods_list||[],t.total=e.data.total,t.list=t.list.map(function(t){t.goods_img_list&&0!==t.goods_img_list.length?t.goods_imgsrc="./php/img_get.php?img=1&width=100&height=100&imgname="+t.goods_img_list[0]:t.goods_imgsrc="";var e=t.spec_type,i=t.goods_price,s=[];switch(i.forEach(function(t){t.time_unit===r.m.MONTH||t.time_unit===r.m.QUARTER?t.itemStr=t.time+"个"+r.m.toString(t.time_unit):t.itemStr=""+t.time+r.m.toString(t.time_unit)}),e){case r.n.SPEC:s=i.map(function(t){var e={};return e.label=t.spec_name,e.price=t.price,e.sale_price=t.sale_price,e});break;case r.n.PACK:s=i.map(function(t){var e={};return e.label=t.package,e.price=t.price,e.sale_price=t.sale_price,e});break;case r.n.SPECANDPACK:s=i.map(function(t){var e={};return e.label=t.spec_name+"/"+t.package,e.price=t.price,e.sale_price=t.sale_price,e});break;case r.n.TERMINAL:s=i.map(function(t){var e={};return e.label=r.I.toString(t.terminal)+"/"+t.itemStr,e.price=t.price,e.sale_price=t.sale_price,e});break;case r.n.SERVERTIME:s=i.map(function(t){var e={};return e.label=""+t.itemStr,e.price=t.price,e.sale_price=t.sale_price,e})}return t.spcePriceList=s,t.hasSalePrice=!1,i.forEach(function(e){e.sale_price&&(t.hasSalePrice=!0)}),t})):t.$slnotify({message:r.X.toString(e.ret)})}))},handleSelectionChange:function(t){this.multipleSelection=t},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=1,this.listQuery.page=t,this.getList()},search:function(){this.emptyType=2,this.listQuery.page=1,this.getList()},clearSearch:function(){this.goods_name="",this.min_price="",this.max_price="",this.category_id="",this.resetCate=!this.resetCate,this.SMG_SET_GOODCATEID({category_id_list:["","",""]}),this.getList()},getSeachList:function(t){this.category_id=t},sort:function(t){this.sortLabel=t.prop,"descending"===t.order?(this.isSort=!0,this.sortOrder=-1):"ascending"===t.order?(this.isSort=!0,this.sortOrder=1):this.isSort=!1,this.getList()},goEdit:function(t){this.$router.push({path:"/officialmanage/goodeditor",query:{goodsid:t}})},deleteGoods:function(){var t=this,e={goods_del:1,goods_id_list:this.goodArrOpr};Object(o.P)(e).then(function(e){0===e.ret?(t.singleDialogDeleteCancel(),t.muDialogDelteCancel(),t.getList(),t.$notify({title:"成功",message:"操作成功！",type:"success"})):t.$notify({title:"成功",message:"操作失败！",type:"error"})})},openSingleDialog:function(t){this.dialogDelId=t,this.singleDelete=!0},openMuDialogDlete:function(){0!==this.multipleSelection.length?this.muDelete=!0:this.$notify({title:"警告",message:"请先选择要批量删除项！",type:"warning"})},singleDialogDelete:function(){this.goodArrOpr=[],this.goodArrOpr.push(this.dialogDelId),this.deleteGoods()},singleDialogDeleteCancel:function(){this.singleDelete=!1},muDialogDelteCancel:function(){this.muDelete=!1},muDialogDelete:function(){this.goodArrOpr=[],this.goodArrOpr=this.multipleSelection.map(function(t){return t.goods_id}),this.deleteGoods()},checkInputPrice:function(t){this[t]=c.a.clearNoNum(this[t])}}),beforeRouteEnter:function(t,e,i){i(function(t){t.SET_SELECTMENU({selectMenu:"/official/shopmall/goods"}),t.SMG_SET_GOODCATEID({category_id_list:["","",""]})})},beforeRouteLeave:function(t,e,i){this.SET_SELECTMENU({selectMenu:""}),this.SMG_SET_GOODCATEID({category_id_list:["","",""]}),i()}}}).call(e,i("L7Pj"))},X3Rq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("C9pl"),a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"goods-draft-table"}},[s("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:">"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/official/shopmall/goods"}}},[t._v("商品管理")]),t._v(" "),s("el-breadcrumb-item",[t._v("商品草稿列表")])],1),t._v(" "),s("div",{staticClass:"draft-content"},[s("div",{staticClass:"search-content clearfix"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item fl change-input"},[s("span",{staticClass:"label-title"},[t._v("商品名称")]),t._v(" "),s("el-input",{staticClass:"spc-input",attrs:{placeholder:"名称或者编号"},model:{value:t.goods_name,callback:function(e){t.goods_name=e},expression:"goods_name"}})],1),t._v(" "),s("div",{staticClass:"search-item clearfix fl change-input"},[s("span",{staticClass:"fl label-title"},[t._v("商品类别")]),t._v(" "),s("select-cate",{staticClass:"fl spc-select",attrs:{"reset-cate":t.resetCate,type:2},on:{"on-change":t.getSeachList}})],1),t._v(" "),s("div",{staticClass:"search-item fl price-input"},[s("span",{staticClass:"label-title"},[t._v("商品价格")]),t._v(" "),s("el-input",{staticClass:"spc-input",attrs:{placeholder:"最低价格"},nativeOn:{keyup:function(e){t.checkInputPrice("min_price")}},model:{value:t.min_price,callback:function(e){t.min_price=e},expression:"min_price"}}),t._v(" "),s("span",[t._v("到")]),t._v(" "),s("el-input",{staticClass:"spc-input",attrs:{placeholder:"最高价格"},nativeOn:{keyup:function(e){t.checkInputPrice("max_price")}},model:{value:t.max_price,callback:function(e){t.max_price=e},expression:"max_price"}})],1),t._v(" "),s("div",{staticClass:"sl-btn-bd-search spc-search-btn",on:{click:t.search}},[t._v("搜索")])]),t._v(" "),s("div",{staticClass:"fr btn-group-font"},[s("div",{staticClass:"sl-btn-bd-search spc-clear-btn",on:{click:t.clearSearch}},[t._v("清空条件")]),t._v(" "),s("div",{staticClass:"sl-btn-bd-search spc-delete-btn",on:{click:t.openMuDialogDlete}},[t._v("删除")])])]),t._v(" "),s("div",{staticClass:"table-content change-default-table change-default"},[s("el-table",{ref:"manageGoodsListTableAdjust",attrs:{data:t.list,stripe:""},on:{"sort-change":t.sort,"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{prop:"num_no",label:"序号",width:"55",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"goods_id",label:"编号","min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.goods_id))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"goods_img",label:"图片","min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{staticClass:"goods_img",attrs:{src:t.row.goods_imgsrc,alt:"good_img"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"goods_name",label:"品名","min-width":"80",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.goods_name))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"1",label:"价格","min-width":"80",align:"center",sortable:"true","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-popover",{attrs:{trigger:"click",placement:"top"}},[s("el-table",{staticClass:"price-spec-table",attrs:{data:e.row.spcePriceList,border:""}},[s("el-table-column",{attrs:{width:"150",property:"label",label:"规格"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.label))]}}])}),t._v(" "),s("el-table-column",{attrs:{width:"100",property:"price",label:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("¥ "+t._s(t._f("numFix")(e.row.price)))]}}])}),t._v(" "),e.row.hasSalePrice?s("el-table-column",{attrs:{width:"100",property:"sale_price",label:"促销价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("¥ "+t._s(t._f("numFix")(e.row.sale_price)))]}}])}):t._e()],1),t._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("span",[t._v("¥ "+t._s(t._f("numFix")(e.row.min_price)))])])],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"category_name",label:"商品类别","min-width":"80",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.category_name))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"apply_time",label:"操作","min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"blue-text",on:{click:function(i){t.goEdit(e.row.goods_id)}}},[t._v("编辑")]),t._v(" "),s("span",{staticClass:"red-text",on:{click:function(i){t.openSingleDialog(e.row.goods_id)}}},[t._v("删除")])]}}])})],1),t._v(" "),t.isListEmpty?s("empty-table",{attrs:{type:t.emptyType}}):t._e()],1),t._v(" "),s("div",{staticClass:"pagination-contentrr change-pagination-default"},[s("el-pagination",{staticClass:"sl-pagination",attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,40],"page-size":t.listQuery.limit,layout:"sizes, jumper, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1),t._v(" "),s("el-dialog",{staticClass:"dialog-custom-b nopadding",attrs:{visible:t.singleDelete,"show-close":!1,"before-close":t.singleDialogDeleteCancel,width:"540px",top:"30vh"},on:{"update:visible":function(e){t.singleDelete=e}}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),s("div",{staticClass:"dialog-content"},[s("div",{staticClass:"delete-tip"},[s("div",{staticClass:"delete-img"},[s("img",{attrs:{src:i("RrKl"),alt:"提示图片"}})]),t._v(" "),s("div",{staticClass:"delete-text"},[t._v("确认删除选中商品？")])]),t._v(" "),s("div",{staticClass:"button-group"},[s("span",{staticClass:"sl-btn-bd-b-blue",on:{click:t.singleDialogDelete}},[t._v("确定")]),t._v(" "),s("span",{staticClass:"sl-btn-bd-b-blue",on:{click:t.singleDialogDeleteCancel}},[t._v("取消")])])])]),t._v(" "),s("el-dialog",{staticClass:"dialog-custom-b nopadding",attrs:{visible:t.muDelete,"show-close":!1,"before-close":t.muDialogDelteCancel,width:"540px",top:"30vh"},on:{"update:visible":function(e){t.muDelete=e}}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),s("div",{staticClass:"dialog-content"},[s("div",{staticClass:"delete-tip"},[s("div",{staticClass:"delete-img"},[s("img",{attrs:{src:i("RrKl"),alt:"提示图片"}})]),t._v(" "),s("div",{staticClass:"delete-text"},[t._v("确认批量删除选中商品？")])]),t._v(" "),s("div",{staticClass:"button-group"},[s("span",{staticClass:"sl-btn-bd-b-blue",on:{click:t.muDialogDelete}},[t._v("确定")]),t._v(" "),s("span",{staticClass:"sl-btn-bd-b-blue",on:{click:t.muDialogDelteCancel}},[t._v("取消")])])])])],1)],1)},staticRenderFns:[]};var l=function(t){i("0ZrM"),i("tpsa")},n=i("C7Lr")(s.a,a,!1,l,"data-v-3722eb0b",null);e.default=n.exports},tpsa:function(t,e){}});